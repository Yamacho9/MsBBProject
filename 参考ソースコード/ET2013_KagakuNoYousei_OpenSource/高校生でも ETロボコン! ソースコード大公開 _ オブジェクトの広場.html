<!DOCTYPE html>
<!-- saved from url=(0077)https://www.ogis-ri.co.jp/otc/hiroba/Report/ETRoboconStudent/open_source.html -->
<html lang="ja"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">

<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
<title>高校生でも ETロボコン! ソースコード大公開 | オブジェクトの広場</title>

<meta name="viewport" content="width=device-width">
<meta content="高校生でも ETロボコン! ソースコード大公開 | オブジェクトの広場" name="title">
<meta content="ETロボコンに参加している高校生チーム「科学の妖精」が、ETロボコン2013の時に作ったソースコードの一部を公開してくれました。" name="description">
<meta property="og:type" content="article">
<meta property="og:title" content="高校生でも ETロボコン! ソースコード大公開 | オブジェクトの広場">
<meta property="og:description" content="ETロボコンに参加している高校生チーム「科学の妖精」が、ETロボコン2013の時に作ったソースコードの一部を公開してくれました。">
<meta property="og:image" content="http://www.ogis-ri.co.jp/otc/hiroba/Report/ETRoboconStudent/img/TeamMember.jpg">
<meta property="og:url" content="http://www.ogis-ri.co.jp/otc/hiroba/Report/ETRoboconStudent/open_source.html">
<meta property="og:locale" content="ja_JP">
<meta property="og:site_name" content="オブジェクトの広場">
<meta property="fb:app_id" content="980506808681624">
<link href="./高校生でも ETロボコン! ソースコード大公開 _ オブジェクトの広場_files/hiroba.css" rel="stylesheet" type="text/css">
<link href="./高校生でも ETロボコン! ソースコード大公開 _ オブジェクトの広場_files/hiroba_article.css" rel="stylesheet" type="text/css">
<!--[if lte IE 8]>
<link href="/otc/hiroba/css/hiroba_ielte8.css" rel="stylesheet" type="text/css" />
<![endif]-->
<link rel="stylesheet" href="./高校生でも ETロボコン! ソースコード大公開 _ オブジェクトの広場_files/etrobostudent.css">
<script id="twitter-wjs" src="./高校生でも ETロボコン! ソースコード大公開 _ オブジェクトの広場_files/widgets.js.ダウンロード"></script><script id="facebook-jssdk" src="./高校生でも ETロボコン! ソースコード大公開 _ オブジェクトの広場_files/sdk.js.ダウンロード"></script><script type="text/javascript" src="./高校生でも ETロボコン! ソースコード大公開 _ オブジェクトの広場_files/urchin.js.ダウンロード"></script>
<script type="text/javascript">
urchinTracker();
</script>
<link href="./高校生でも ETロボコン! ソースコード大公開 _ オブジェクトの広場_files/hiroba_prettify.css" rel="stylesheet" type="text/css">
<script type="text/javascript" src="./高校生でも ETロボコン! ソースコード大公開 _ オブジェクトの広場_files/prettify.js.ダウンロード"></script>


<script type="text/javascript" charset="utf-8" async="" src="./高校生でも ETロボコン! ソースコード大公開 _ オブジェクトの広場_files/button.90facfc7dd48c9c8c4f1fc94e137b515.js.ダウンロード"></script><style type="text/css">.fb_hidden{position:absolute;top:-10000px;z-index:10001}.fb_reposition{overflow:hidden;position:relative}.fb_invisible{display:none}.fb_reset{background:none;border:0;border-spacing:0;color:#000;cursor:auto;direction:ltr;font-family:"lucida grande", tahoma, verdana, arial, "hiragino kaku gothic pro",meiryo,"ms pgothic",sans-serif;font-size:11px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;line-height:1;margin:0;overflow:visible;padding:0;text-align:left;text-decoration:none;text-indent:0;text-shadow:none;text-transform:none;visibility:visible;white-space:normal;word-spacing:normal}.fb_reset>div{overflow:hidden}.fb_link img{border:none}@keyframes fb_transform{from{opacity:0;transform:scale(.95)}to{opacity:1;transform:scale(1)}}.fb_animate{animation:fb_transform .3s forwards}
.fb_dialog{background:rgba(82, 82, 82, .7);position:absolute;top:-10000px;z-index:10001}.fb_reset .fb_dialog_legacy{overflow:visible}.fb_dialog_advanced{padding:10px;-moz-border-radius:8px;-webkit-border-radius:8px;border-radius:8px}.fb_dialog_content{background:#fff;color:#333}.fb_dialog_close_icon{background:url(http://static.xx.fbcdn.net/rsrc.php/v3/yq/r/IE9JII6Z1Ys.png) no-repeat scroll 0 0 transparent;cursor:pointer;display:block;height:15px;position:absolute;right:18px;top:17px;width:15px}.fb_dialog_mobile .fb_dialog_close_icon{top:5px;left:5px;right:auto}.fb_dialog_padding{background-color:transparent;position:absolute;width:1px;z-index:-1}.fb_dialog_close_icon:hover{background:url(http://static.xx.fbcdn.net/rsrc.php/v3/yq/r/IE9JII6Z1Ys.png) no-repeat scroll 0 -15px transparent}.fb_dialog_close_icon:active{background:url(http://static.xx.fbcdn.net/rsrc.php/v3/yq/r/IE9JII6Z1Ys.png) no-repeat scroll 0 -30px transparent}.fb_dialog_loader{background-color:#f6f7f9;border:1px solid #606060;font-size:24px;padding:20px}.fb_dialog_top_left,.fb_dialog_top_right,.fb_dialog_bottom_left,.fb_dialog_bottom_right{height:10px;width:10px;overflow:hidden;position:absolute}.fb_dialog_top_left{background:url(http://static.xx.fbcdn.net/rsrc.php/v3/ye/r/8YeTNIlTZjm.png) no-repeat 0 0;left:-10px;top:-10px}.fb_dialog_top_right{background:url(http://static.xx.fbcdn.net/rsrc.php/v3/ye/r/8YeTNIlTZjm.png) no-repeat 0 -10px;right:-10px;top:-10px}.fb_dialog_bottom_left{background:url(http://static.xx.fbcdn.net/rsrc.php/v3/ye/r/8YeTNIlTZjm.png) no-repeat 0 -20px;bottom:-10px;left:-10px}.fb_dialog_bottom_right{background:url(http://static.xx.fbcdn.net/rsrc.php/v3/ye/r/8YeTNIlTZjm.png) no-repeat 0 -30px;right:-10px;bottom:-10px}.fb_dialog_vert_left,.fb_dialog_vert_right,.fb_dialog_horiz_top,.fb_dialog_horiz_bottom{position:absolute;background:#525252;filter:alpha(opacity=70);opacity:.7}.fb_dialog_vert_left,.fb_dialog_vert_right{width:10px;height:100%}.fb_dialog_vert_left{margin-left:-10px}.fb_dialog_vert_right{right:0;margin-right:-10px}.fb_dialog_horiz_top,.fb_dialog_horiz_bottom{width:100%;height:10px}.fb_dialog_horiz_top{margin-top:-10px}.fb_dialog_horiz_bottom{bottom:0;margin-bottom:-10px}.fb_dialog_iframe{line-height:0}.fb_dialog_content .dialog_title{background:#6d84b4;border:1px solid #365899;color:#fff;font-size:14px;font-weight:bold;margin:0}.fb_dialog_content .dialog_title>span{background:url(http://static.xx.fbcdn.net/rsrc.php/v3/yd/r/Cou7n-nqK52.gif) no-repeat 5px 50%;float:left;padding:5px 0 7px 26px}body.fb_hidden{-webkit-transform:none;height:100%;margin:0;overflow:visible;position:absolute;top:-10000px;left:0;width:100%}.fb_dialog.fb_dialog_mobile.loading{background:url(http://static.xx.fbcdn.net/rsrc.php/v3/ya/r/3rhSv5V8j3o.gif) white no-repeat 50% 50%;min-height:100%;min-width:100%;overflow:hidden;position:absolute;top:0;z-index:10001}.fb_dialog.fb_dialog_mobile.loading.centered{width:auto;height:auto;min-height:initial;min-width:initial;background:none}.fb_dialog.fb_dialog_mobile.loading.centered #fb_dialog_loader_spinner{width:100%}.fb_dialog.fb_dialog_mobile.loading.centered .fb_dialog_content{background:none}.loading.centered #fb_dialog_loader_close{color:#fff;display:block;padding-top:20px;clear:both;font-size:18px}#fb-root #fb_dialog_ipad_overlay{background:rgba(0, 0, 0, .45);position:absolute;bottom:0;left:0;right:0;top:0;width:100%;min-height:100%;z-index:10000}#fb-root #fb_dialog_ipad_overlay.hidden{display:none}.fb_dialog.fb_dialog_mobile.loading iframe{visibility:hidden}.fb_dialog_content .dialog_header{-webkit-box-shadow:white 0 1px 1px -1px inset;background:-webkit-gradient(linear, 0% 0%, 0% 100%, from(#738ABA), to(#2C4987));border-bottom:1px solid;border-color:#1d4088;color:#fff;font:14px Helvetica, sans-serif;font-weight:bold;text-overflow:ellipsis;text-shadow:rgba(0, 30, 84, .296875) 0 -1px 0;vertical-align:middle;white-space:nowrap}.fb_dialog_content .dialog_header table{-webkit-font-smoothing:subpixel-antialiased;height:43px;width:100%}.fb_dialog_content .dialog_header td.header_left{font-size:12px;padding-left:5px;vertical-align:middle;width:60px}.fb_dialog_content .dialog_header td.header_right{font-size:12px;padding-right:5px;vertical-align:middle;width:60px}.fb_dialog_content .touchable_button{background:-webkit-gradient(linear, 0% 0%, 0% 100%, from(#4966A6), color-stop(.5, #355492), to(#2A4887));border:1px solid #29487d;-webkit-background-clip:padding-box;-webkit-border-radius:3px;-webkit-box-shadow:rgba(0, 0, 0, .117188) 0 1px 1px inset, rgba(255, 255, 255, .167969) 0 1px 0;display:inline-block;margin-top:3px;max-width:85px;line-height:18px;padding:4px 12px;position:relative}.fb_dialog_content .dialog_header .touchable_button input{border:none;background:none;color:#fff;font:12px Helvetica, sans-serif;font-weight:bold;margin:2px -12px;padding:2px 6px 3px 6px;text-shadow:rgba(0, 30, 84, .296875) 0 -1px 0}.fb_dialog_content .dialog_header .header_center{color:#fff;font-size:16px;font-weight:bold;line-height:18px;text-align:center;vertical-align:middle}.fb_dialog_content .dialog_content{background:url(http://static.xx.fbcdn.net/rsrc.php/v3/y9/r/jKEcVPZFk-2.gif) no-repeat 50% 50%;border:1px solid #555;border-bottom:0;border-top:0;height:150px}.fb_dialog_content .dialog_footer{background:#f6f7f9;border:1px solid #555;border-top-color:#ccc;height:40px}#fb_dialog_loader_close{float:left}.fb_dialog.fb_dialog_mobile .fb_dialog_close_button{text-shadow:rgba(0, 30, 84, .296875) 0 -1px 0}.fb_dialog.fb_dialog_mobile .fb_dialog_close_icon{visibility:hidden}#fb_dialog_loader_spinner{animation:rotateSpinner 1.2s linear infinite;background-color:transparent;background-image:url(http://static.xx.fbcdn.net/rsrc.php/v3/yD/r/t-wz8gw1xG1.png);background-repeat:no-repeat;background-position:50% 50%;height:24px;width:24px}@keyframes rotateSpinner{0%{transform:rotate(0deg)}100%{transform:rotate(360deg)}}
.fb_iframe_widget{display:inline-block;position:relative}.fb_iframe_widget span{display:inline-block;position:relative;text-align:justify}.fb_iframe_widget iframe{position:absolute}.fb_iframe_widget_fluid_desktop,.fb_iframe_widget_fluid_desktop span,.fb_iframe_widget_fluid_desktop iframe{max-width:100%}.fb_iframe_widget_fluid_desktop iframe{min-width:220px;position:relative}.fb_iframe_widget_lift{z-index:1}.fb_hide_iframes iframe{position:relative;left:-10000px}.fb_iframe_widget_loader{position:relative;display:inline-block}.fb_iframe_widget_fluid{display:inline}.fb_iframe_widget_fluid span{width:100%}.fb_iframe_widget_loader iframe{min-height:32px;z-index:2;zoom:1}.fb_iframe_widget_loader .FB_Loader{background:url(http://static.xx.fbcdn.net/rsrc.php/v3/y9/r/jKEcVPZFk-2.gif) no-repeat;height:32px;width:32px;margin-left:-16px;position:absolute;left:50%;z-index:4}</style></head>
<body onload="prettyPrint()">
<div id="fb-root" class=" fb_reset"><div style="position: absolute; top: -10000px; height: 0px; width: 0px;"><div><iframe name="fb_xdm_frame_https" frameborder="0" allowtransparency="true" allowfullscreen="true" scrolling="no" id="fb_xdm_frame_https" aria-hidden="true" title="Facebook Cross Domain Communication Frame" tabindex="-1" src="./高校生でも ETロボコン! ソースコード大公開 _ オブジェクトの広場_files/0F7S7QWJ0Ac.html" style="border: none;"></iframe></div></div><div style="position: absolute; top: -10000px; height: 0px; width: 0px;"><div></div></div></div>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) return;
  js = d.createElement(s); js.id = id;
  js.src = "//connect.facebook.net/ja_JP/sdk.js#xfbml=1&version=v2.7&appId=980506808681624";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>
<script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script>

<header>
<div id="common-header" class="cf">
  <div id="site-info">
    <div class="inner">
    <div id="header-logo" class="cf"><a href="https://www.ogis-ri.co.jp/otc/hiroba/"><img src="./高校生でも ETロボコン! ソースコード大公開 _ オブジェクトの広場_files/OBJECT_SQUARE.gif" alt="オブジェクトの広場" width="135" height="50"></a></div>
    <p id="site-desc">オブジェクトの広場は株式会社オージス総研グループのエンジニアによる技術発表サイトです</p>
    </div>
  </div>
  <div id="navi-onheader" class="cf">
    <div class="inner">
    <ul>
      <li><a href="https://www.ogis-ri.co.jp/otc/hiroba/topic/">分野別記事</a></li>
      <li><a href="https://www.ogis-ri.co.jp/otc/hiroba/ogisbooks/">Books</a></li>
      <li><a href="https://www.ogis-ri.co.jp/otc/hiroba/editors/">About us</a></li>
    </ul>
    </div>
  </div>
</div>

</header>
<div id="main" class="cf">
<article class="common-contents">
<section>
<div id="simple-navi">
  <a href="https://www.ogis-ri.co.jp/otc/hiroba/Report/ETRoboconStudent/last.html">« prev</a> |
    <a href="https://www.ogis-ri.co.jp/otc/hiroba/Report/ETRoboconStudent/">index</a> |
</div>

<div id="category" class="cf">ETロボコン特集</div>

<div id="article-info">
  <div id="title">
  <h1>高校生でも ETロボコン! ソースコード大公開</h1>
  </div>
  <div class="issued-on">
	2014年10月9日</div>

<div class="sns-btns cf"><ul><li class="twitter-btn"><iframe id="twitter-widget-0" scrolling="no" frameborder="0" allowtransparency="true" class="twitter-share-button twitter-share-button-rendered twitter-tweet-button" title="Twitter Tweet Button" src="./高校生でも ETロボコン! ソースコード大公開 _ オブジェクトの広場_files/tweet_button.5b6375bb17bd9edb2f4e7f8f12971999.ja.html" style="position: static; visibility: visible; width: 75px; height: 20px;"></iframe></li><li><div class="fb-like fb_iframe_widget" data-href="https://www.ogis-ri.co.jp/otc/hiroba/Report/ETRoboconStudent/open_source.html" data-layout="button_count" data-action="like" data-size="small" data-show-faces="false" data-share="true" fb-xfbml-state="rendered" fb-iframe-plugin-query="action=like&amp;app_id=980506808681624&amp;container_width=0&amp;href=https%3A%2F%2Fwww.ogis-ri.co.jp%2Fotc%2Fhiroba%2FReport%2FETRoboconStudent%2Fopen_source.html&amp;layout=button_count&amp;locale=ja_JP&amp;sdk=joey&amp;share=true&amp;show_faces=false&amp;size=small"><span style="vertical-align: bottom; width: 129px; height: 20px;"><iframe name="f2db6f03a75a3c8" width="1000px" height="1000px" frameborder="0" allowtransparency="true" allowfullscreen="true" scrolling="no" title="fb:like Facebook Social Plugin" src="./高校生でも ETロボコン! ソースコード大公開 _ オブジェクトの広場_files/like.html" style="border: none; visibility: visible; width: 129px; height: 20px;" class=""></iframe></span></div></li></ul></div>

</div>
<div id="lead" class="cf"><p>ETロボコンに参加している高校生チーム「科学の妖精」が、<a href="http://www.etrobo.jp/2013/">ETロボコン2013</a>の時に作ったソースコードの一部を公開してくれました。</p><p>実際にETロボコンで使ったソースコードの公開は、過去にほぼ例のないことだと思います。これからETロボコンに参加しようと考えているチームにとっては、大いに参考になると思いますし、既に参加しているチームにとっても、高校生チームの実力を知ることは良い刺激になると思います。ぜひご覧ください。</p><p>尚、公開するソースコードは、C++コードとしてまだまだ未熟なところがあります。ですが、「もっと高校生チームの参加を増やしたい」という「科学の妖精」の好意と熱意のもと公開していますので、多少の粗には目をつむり、温かい目で見ていただければ幸いです。そして、アドバイスなどあれば、ぜひフィードバックしてあげてください。(オブジェクトの広場編集部)</p></div>

<div id="article-main" class="cf">
<h1 class="subsection">ETロボコン ソースコード公開</h1>
<div class="authors">聖望学園高等学校 科学部部長 小泉 祐貴</div>
<h2>はじめに</h2>
<p><a href="http://www.seibou.ac.jp/club/cultural-h/science-h/">聖望学園高等学校科学部</a>に所属している私たちは、ロボットを作ったりプログラミングをしたり、時には植物や生き物を育てたりしています。そんなメンバーで構成されているチーム「科学の妖精」は、ET ロボコン北関東大会に 2011 年から 3 年連続で総合優勝しチャンピオンシップ大会に出場しました。そして、ETロボコン 2013 チャンピオンシップ大会では総合 15 位（27 チーム中）の結果を出すことができました。</p>
<p>今回私達が作成したプログラムを公開するのに至った背景は、ET ロボコンに参加しようと考えている高校生に役に立つ情報を提供することによって、高校生チームがどんどん増えてくれればと思ったからです。少しでもその手助けになればうれしいです。</p>
<p>尚、今回公開する ソースコードは、ET ロボコン 2013 のベーシックステージ（ライントレースのみ行うステージ）で使ったものをもとにしています。</p>

<h2>ライセンス</h2>
<p>当ソースコードは、MIT ライセンスで公開しています。MIT ライセンスについては、SourceForge.JP の下記ページを参照してください。</p>
<p><a href="http://sourceforge.jp/projects/opensource/wiki/licenses%2FMIT_license" target="_blank">http://sourceforge.jp/projects/opensource/wiki/licenses%2FMIT_license</a></p>

<h2>ダウンロード</h2>
<p>ETロボコン 2013 科学の妖精 ソースコード <a href="https://www.ogis-ri.co.jp/otc/hiroba/Report/ETRoboconStudent/ET2013_KagakuNoYousei_OpenSource.zip">ET2013_KagakuNoYousei_OpenSource.zip</a>（24KB）</p>

<h2>問い合わせ先</h2>
<p>質問やアドバイスなどあれば、連絡をください。</p>
<p>科学の妖精 メールアドレス: infoアトseiboukagakubu.sakura.ne.jp （メールを送信される場合には「アト」は@に置き換えてください）</p>

<h2>ソースコードの説明</h2>

<h3>プログラミング言語は？</h3>
<p>倒立振子制御パラメータ（RunMethod/balancer_param.c）は C言語、それ以外は C++ です。</p>

<h3>何ができる？</h3>
<p>ETロボコンのレプリカコースやサンプルコースの左エッジ（ラインの左端）を、ETロボコン 2011 ～ 2014 の「二輪倒立振子ロボット」で、下記の順にライントレースさせることができます。</p>
<ol>
  <li>総走行距離（スタートからの走行距離）が 100cm になるまで、ライントレースをスピード 20 で行う</li>
  <li>総走行距離（スタートからの走行距離）が 200cm になるまで、ライントレースをスピード 30 で行う</li>
  <li>総走行距離（スタートからの走行距離）が 300cm になるまで、ライントレースをスピード 40 で行う</li>
</ol>

<p>総走行距離やスピードを変えたい場合は、Competition.cpp の下記の値を変更してください。</p>
<ul>
  <li>AllDistanceCondition コンストラクタの第一引数。総走行距離（スタートからの走行距離）を表す。176～178行目。</li>
  <li>LineTraceMethod コンストラクタの第五引数。ライントレースのスピードを表す。181～183行目。</li>
</ul>

<pre class="prettyprint linenums:175 prettyprinted"><ol class="linenums"><li value="175" class="L4"><span class="pln">  </span><span class="com">//INコースのベーシックの終了条件を設定</span></li><li class="L5"><span class="pln">  in01 </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">AllDistanceCondition</span><span class="pun">(</span><span class="lit">100</span><span class="pun">,&amp;</span><span class="pln">leftMotor</span><span class="pun">,&amp;</span><span class="pln">rightMotor</span><span class="pun">);</span></li><li class="L6"><span class="pln">  in02 </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">AllDistanceCondition</span><span class="pun">(</span><span class="lit">200</span><span class="pun">,&amp;</span><span class="pln">leftMotor</span><span class="pun">,&amp;</span><span class="pln">rightMotor</span><span class="pun">);</span></li><li class="L7"><span class="pln">  in03 </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">AllDistanceCondition</span><span class="pun">(</span><span class="lit">300</span><span class="pun">,&amp;</span><span class="pln">leftMotor</span><span class="pun">,&amp;</span><span class="pln">rightMotor</span><span class="pun">);</span></li><li class="L8"><span class="pln">&nbsp;</span></li><li class="L9"><span class="pln">  </span><span class="com">//INコースのベーシックの走行方法を設定</span></li><li class="L0"><span class="pln">  run_straight   </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">LineTraceMethod</span><span class="pun">(</span><span class="pln">calibration</span><span class="pun">,</span><span class="pln">ver</span><span class="pun">,</span><span class="pln">pid_light</span><span class="pun">,</span><span class="lit">20</span><span class="pun">,</span><span class="lit">50</span><span class="pun">,&amp;</span><span class="pln">lightSensor</span><span class="pun">,&amp;</span><span class="pln">leftMotor</span><span class="pun">,&amp;</span><span class="pln">rightMotor</span><span class="pun">);</span></li><li class="L1"><span class="pln">  run_slope_up   </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">LineTraceMethod</span><span class="pun">(</span><span class="pln">calibration</span><span class="pun">,</span><span class="pln">ver</span><span class="pun">,</span><span class="pln">pid_light</span><span class="pun">,</span><span class="lit">30</span><span class="pun">,</span><span class="lit">50</span><span class="pun">,&amp;</span><span class="pln">lightSensor</span><span class="pun">,&amp;</span><span class="pln">leftMotor</span><span class="pun">,&amp;</span><span class="pln">rightMotor</span><span class="pun">);</span></li><li class="L2"><span class="pln">  run_slope_down </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">LineTraceMethod</span><span class="pun">(</span><span class="pln">calibration</span><span class="pun">,</span><span class="pln">ver</span><span class="pun">,</span><span class="pln">pid_light</span><span class="pun">,</span><span class="lit">40</span><span class="pun">,</span><span class="lit">50</span><span class="pun">,&amp;</span><span class="pln">lightSensor</span><span class="pun">,&amp;</span><span class="pln">leftMotor</span><span class="pun">,&amp;</span><span class="pln">rightMotor</span><span class="pun">);</span></li></ol></pre>

<h3>どんな設計？</h3>
<p>下記のクラス図を参照してください。クリックすると拡大します。<br>API 関連のクラスは省略しています。また、パッケージ毎にクラスを色分けしています。</p>
<p><a href="./高校生でも ETロボコン! ソースコード大公開 _ オブジェクトの広場_files/design_model.png" target="_blank"><img src="./高校生でも ETロボコン! ソースコード大公開 _ オブジェクトの広場_files/design_model.png" alt="Design Model" height="320" width="800" style="max-width:100%;height:auto;"></a></p>

<h2>動かし方</h2>
<p>ソースコードは実際に動かすことができます。興味があれば、ぜひ動かしてみてください。</p>

<h3>動作条件</h3>
<ul>
  <li>Windows PC を使用</li>
  <li>NXT BIOS を使用</li>
  <li>ETロボコン 2011 ～ 2014 の「二輪倒立振子ロボット」を使用</li>
  <li>ETロボコンのレプリカコース、もしくは、サンプルコースを使用</li>
</ul>

<h3>開発環境の準備</h3>
<p>下記のページを参考に、PC と NXT に必要なソフトウェアを入れてください。</p>
<p><a href="http://lejos-osek.sourceforge.net/jp/installation_nb.htm" target="_blank">http://lejos-osek.sourceforge.net/jp/installation_nb.htm</a></p>

<h3>走行体の組み立て</h3>
<p>ETロボコン 2011 ～ 2014（ビギナーコース）で配布された「二輪倒立振子ロボット」の組み立て手順書に従って組み立ててください。特に、モジュールの接続ポートには気を付けてください。</p>
<ul>
  <li>ポートA : 尻尾モータ</li>
  <li>ポートB : 右モータ</li>
  <li>ポートC : 左モータ</li>
  <li>ポート1 : ジャイロセンサ</li>
  <li>ポート2 : 超音波センサ</li>
  <li>ポート3 : 光センサ</li>
  <li>ポート4 : タッチセンサ</li>
</ul>

<h3>ビルド</h3>
<p>ダウンロードしたソースコードをビルドしてください。</p>
<ol>
  <li>ソースコードをダウンロードし、パスにスペースを含まない任意の場所に解凍します。<br>例 &gt; C:/ET2013_KagakuNoYousei_OpenSource</li>
  <li>Makefile を開き、Cygwin をインストールした場所に合わせて、NXTOSEK_ROOT と TOPPERS_OSEK_ROOT_SG を変更します。C:/Cygwin にインストールした場合は、変更不要です。
<pre class="prettyprint linenums prettyprinted"><ol class="linenums"><li class="L0"><span class="com"># nxtOSEKルートディレクトリ</span></li><li class="L1"><span class="pln">NXTOSEK_ROOT </span><span class="pun">=</span><span class="pln"> </span><span class="str">/cygdrive/</span><span class="pln">c</span><span class="pun">/</span><span class="pln">cygwin</span><span class="pun">/</span><span class="pln">nxtOSEK</span></li><li class="L2"><span class="pln">&nbsp;</span></li><li class="L3"><span class="com"># toppers_osekディレクトリ  ※DOS形式</span></li><li class="L4"><span class="pln">TOPPERS_OSEK_ROOT_SG </span><span class="pun">=</span><span class="pln"> C</span><span class="pun">:</span><span class="str">/cygwin/</span><span class="pln">nxtOSEK</span><span class="pun">/</span><span class="pln">toppers_osek</span></li></ol></pre></li>
  <li>Cygwin を起動し、cd コマンドを使って、ソースコードを解凍したディレクトリに移動します。
<pre class="console">$ cd C:/ET2013_KagakuNoYousei_OpenSource
</pre></li>
  <li>make all を実行し、ビルドします。バイナリイメージができれば OK です。
<pre class="console">$ make all
...(省略)...
Generating binary image file: et2013_rom.bin <span class="comment">←これが表示されればOK</span>

        <span style="color:#808000;">/cygdrive/c/ET2013_KagakunoYousei_OpenSource</span>
$
</pre></li>
</ol>

<h3>走行体へアップロード</h3>
<p>NXT を READY 状態（プログラムアップロード待ち状態）にし、プログラムをアップロードしてください。</p>
<ol>
  <li>NXT の電源を入れます。</li>
  <li>オレンジボタンと左ボタンを同時に押します。その後、NXTの電源が落ちます。<br>
    <img src="./高校生でも ETロボコン! ソースコード大公開 _ オブジェクトの広場_files/upload_01.png" alt="オレンジボタンと左ボタン"></li>
  <li>再度、NXT の電源を入れます。NXT が READY 状態（プログラムアップロード待ち状態）になることを確認します。</li>
  <li>PC と NXT を USB ケーブルで接続します。</li>
  <li>Cygwin を起動し、cd コマンドを使って、ソースコードを解凍したディレクトリに移動します。
<pre class="console">$ cd C:/ET2013_KagakuNoYousei_OpenSource
</pre></li>
  <li>sh ./appflash.sh を実行し、プログラムを NXT へアップロードします。"Successful completion of uploading" と最後に表示されれば、成功です。
<pre class="console">$ sh ./appflash.sh
</pre></li>
  <li>NXT が FINISHED 状態になったことを確認し、NXT の電源を落とします。</li>
</ol>

<h3>走行スタート</h3>
<p>黒ライン、白ライン、灰色マーカの光センサ値をキャリブレーションし、走行をスタートしてください。
</p>
<video controls="" width="320" height="180">
<source src="start_run.mp4">
<p>スタートの手順を動画で用意しました。動画が表示されない時は下記のリンクからご覧になって下さい。<br><a href="https://www.ogis-ri.co.jp/otc/hiroba/Report/ETRoboconStudent/start_run.mp4" target="_blank">start_run.mp4</a></p>
</video>
<ol>
  <li>NXT の電源を入れます。</li>
  <li>NXT の右ボタンを押し、プログラムを実行します。<br>
    <img src="./高校生でも ETロボコン! ソースコード大公開 _ オブジェクトの広場_files/start_01.png" alt="右ボタン"></li>
  <li>ディスプレイに「Connect by BT or press RUN button」と表示されるので、右ボタンを押します。</li>
  <li>走行体の光センサを黒ライン上にくるように置き、タッチセンサを押します（音が 1 回鳴ります）。この時、走行体とコース面は垂直にします。</li>
  <li>同様に、走行体の光センサを白ライン上にくるように置き、タッチセンサを押します（音が 1 回鳴ります）。</li>
  <li>同様に、走行体の光センサを灰色マーカ上にくるように置き、タッチセンサを押します（音が 1 回鳴ります）。</li>
  <li>タッチセンサを押し、尻尾が下がるのを確認したら、黒ラインの左エッジに走行体を設置します。</li>
  <li>タッチセンサを押し、走行準備モードにします。</li>
  <li>タッチセンサを押し、走行をスタートします。</li>
</ol>

<h2>うまく倒立しない場合は</h2>
<p>走行体がうまく倒立せず、ブレたり、倒れたりする場合は、ジャイロセンサのオフセット値を変更してみてください。</p>
<ol>
  <li>Cygwin を起動し、cd コマンドを使って、nxtOSEK/samples_c/helloworld に移動します。<br>例 &gt; cd C:/Cygwin/nxtOSEK/samples_c/helloworld</li>
  <li>上の記述を参考に、「ビルド」と「走行体へアップロード」を行います。</li>
  <li>NXT の電源を入れます。</li>
  <li>NXT の右ボタンを押し、プログラムを実行します。</li>
  <li>走行体を寝かせ、完全に停止させます。</li>
  <li>この時のジャイロセンサの値（＝オフセット値）を確認します。<br>
    <img src="./高校生でも ETロボコン! ソースコード大公開 _ オブジェクトの広場_files/gyro_sensor_offset_01.png" alt="ジャイロセンサの値"></li>
  <li>RunMethod/Vertical.cpp を開き、36行目のジャイロオフセット値を変更します。
<pre class="prettyprint linenums:35 prettyprinted"><ol class="linenums"><li value="35" class="L4"><span class="pln">&nbsp;</span></li><li class="L5"><span class="pln">    </span><span class="kwd">float</span><span class="pln"> GYRO_OFFSET</span><span class="pun">=</span><span class="lit">611</span><span class="pun">;</span><span class="pln">    </span><span class="com">//ジャイロオフセット値</span></li><li class="L6"><span class="pln">    </span><span class="kwd">signed</span><span class="pln"> </span><span class="kwd">char</span><span class="pln"> forward</span><span class="pun">;</span><span class="pln">      </span><span class="com">//前後進命令    </span></li></ol></pre></li>
</ol>


</div>
<div class="sns-btns cf"><ul><li class="twitter-btn"><iframe id="twitter-widget-1" scrolling="no" frameborder="0" allowtransparency="true" class="twitter-share-button twitter-share-button-rendered twitter-tweet-button" title="Twitter Tweet Button" src="./高校生でも ETロボコン! ソースコード大公開 _ オブジェクトの広場_files/tweet_button.5b6375bb17bd9edb2f4e7f8f12971999.ja(1).html" style="position: static; visibility: visible; width: 75px; height: 20px;"></iframe></li><li><div class="fb-like fb_iframe_widget" data-href="https://www.ogis-ri.co.jp/otc/hiroba/Report/ETRoboconStudent/open_source.html" data-layout="button_count" data-action="like" data-size="small" data-show-faces="false" data-share="true" fb-xfbml-state="rendered" fb-iframe-plugin-query="action=like&amp;app_id=980506808681624&amp;container_width=0&amp;href=https%3A%2F%2Fwww.ogis-ri.co.jp%2Fotc%2Fhiroba%2FReport%2FETRoboconStudent%2Fopen_source.html&amp;layout=button_count&amp;locale=ja_JP&amp;sdk=joey&amp;share=true&amp;show_faces=false&amp;size=small"><span style="vertical-align: bottom; width: 129px; height: 20px;"><iframe name="f123542a69564ec" width="1000px" height="1000px" frameborder="0" allowtransparency="true" allowfullscreen="true" scrolling="no" title="fb:like Facebook Social Plugin" src="./高校生でも ETロボコン! ソースコード大公開 _ オブジェクトの広場_files/like(1).html" style="border: none; visibility: visible; width: 129px; height: 20px;" class=""></iframe></span></div></li></ul></div>

<div id="bottom-navi">
  <a href="https://www.ogis-ri.co.jp/otc/hiroba/Report/ETRoboconStudent/last.html"><span class="left">« prev</span></a>
</div>

</section>
<aside>
﻿<div id="enquete" class="cf">
  <form action="https://www.ogis-ri.co.jp/cgi-bin/otc/hiroba/kiji_enquete.cgi" method="post">
  <input value="高校生でも ETロボコン! ソースコード大公開" name="title" type="hidden">
  <input name="url" value="http://www.ogis-ri.co.jp/otc/hiroba/Report/ETRoboconStudent/open_source.html" type="hidden">
  <p>記事の内容を 5 点満点で評価してください。</p>
  <p>
  <input name="mark" value="1" class="enquete" type="radio">1点
  <input name="mark" value="2" class="enquete" type="radio">2点
  <input name="mark" value="3" class="enquete" checked="checked" type="radio">3点
  <input name="mark" value="4" class="enquete" type="radio">4点
  <input name="mark" value="5" class="enquete" type="radio">5点
  </p>
  <p>記事に関するコメントがあれば併せてご記入ください。</p>
  <p><textarea name="text"></textarea></p>
  <input value="送信" type="submit">
  </form>
</div>

  <div class="ref-box cf v-space"><p>連載記事一覧</p><ul><li><a href="https://www.ogis-ri.co.jp/otc/hiroba/Report/ETRoboconStudent/first.html">モデリングに挑戦（前編） (2013年7月公開)</a></li><li><a href="https://www.ogis-ri.co.jp/otc/hiroba/Report/ETRoboconStudent/last.html">モデリングに挑戦（後編） (2013年8月公開)</a></li><li><a href="https://www.ogis-ri.co.jp/otc/hiroba/Report/ETRoboconStudent/open_source.html">ソースコード大公開 (2014年10月公開)</a></li></ul></div>


<aside id="trends" class="cf">
<h2>人気の記事</h2>
<div class="grid2-1">
<div class="h-space v-space cf">
<div class="icon"><a href="https://www.ogis-ri.co.jp/otc/hiroba/technical/clair/part1.html"><img src="./高校生でも ETロボコン! ソースコード大公開 _ オブジェクトの広場_files/clair-overview.png"></a></div>
<div class="abst"><a href="https://www.ogis-ri.co.jp/otc/hiroba/technical/clair/part1.html">Clair によるコンテナ・イメージの脆弱性検出 - 第1回 Docker と Cl...</a></div>
</div>
</div>
<div class="grid2-2">
<div class="h-space v-space cf">
<div class="icon"><a href="https://www.ogis-ri.co.jp/otc/hiroba/technical/docker/part1.html"><img src="./高校生でも ETロボコン! ソースコード大公開 _ オブジェクトの広場_files/docker_vs_hv.png"></a></div>
<div class="abst"><a href="https://www.ogis-ri.co.jp/otc/hiroba/technical/docker/part1.html">さわって理解するDocker入門 - 第1回 Dockerのイメージ・コンテナ管理の仕組み</a></div>
</div>
</div>
<div class="grid2-1">
<div class="h-space v-space cf">
<div class="icon"><a href="https://www.ogis-ri.co.jp/otc/hiroba/technical/openid-connect/chap1.html"><img src="./高校生でも ETロボコン! ソースコード大公開 _ オブジェクトの広場_files/pic201510-006.png"></a></div>
<div class="abst"><a href="https://www.ogis-ri.co.jp/otc/hiroba/technical/openid-connect/chap1.html">第一回 認証基盤のこれからを支えるOpenID Connect - OpenID C...</a></div>
</div>
</div>
<div class="grid2-2">
<div class="h-space v-space cf">
<div class="icon"><a href="https://www.ogis-ri.co.jp/otc/hiroba/technical/WebAPI/part1.html"><img src="./高校生でも ETロボコン! ソースコード大公開 _ オブジェクトの広場_files/4.png"></a></div>
<div class="abst"><a href="https://www.ogis-ri.co.jp/otc/hiroba/technical/WebAPI/part1.html">これから始めるエンタープライズ Web API 開発 - 第1回 Web API 普...</a></div>
</div>
</div>
</aside>




</aside>
</article>
<aside id="common-menu">
<div class="menu-block cf">
<div class="menu-label">Links</div>
<div class="grid4">  
  <a href="https://www.ogis-ri.co.jp/extra/contest/" target="_blank">
  <div class="link-logo" style="background-color:#f2edde;">
	<span><img src="./高校生でも ETロボコン! ソースコード大公開 _ オブジェクトの広場_files/osca-banner-hiroba.png" alt="OSCA" width="90"></span>
  </div>
  </a>
</div>
<div class="grid4">  
  <a href="http://www.scaledagileframework.com/jp/" target="_blank">
  <div class="link-logo">
	<span><img src="./高校生でも ETロボコン! ソースコード大公開 _ オブジェクトの広場_files/SAFe-Acronym-logo-final-jp-120px.png" alt="SAFe日本語サイト" width="90"></span>
  </div>
  </a>
</div>
<div class="grid4">  
  <a href="https://www.ogis-ri.co.jp/otc/swec/process/am-res/am/" target="_blank">
  <div class="link-logo" style="background-color:#fff">
	<span><img src="./高校生でも ETロボコン! ソースコード大公開 _ オブジェクトの広場_files/am_logo.gif" alt="アジャイルモデリング" width="90"></span>
  </div>
  </a>
</div>
<div class="grid4">  
  <a href="https://www.ogis-ri.co.jp/otc/swec/process/eup-res/eup/" target="_blank">
  <div class="link-logo" style="background-color:#fff">
	<span><img src="./高校生でも ETロボコン! ソースコード大公開 _ オブジェクトの広場_files/eupLogo.gif" alt="エンタープライズUP" width="90"></span>
  </div>
  </a>
</div>
</div>

<div class="menu-block cf">
<div class="menu-label">Back Numbers</div>
<ul class="menu-list">
  <li><a href="https://www.ogis-ri.co.jp/otc/hiroba/top2017.html"><div>2017年</div></a></li>
  <li><a href="https://www.ogis-ri.co.jp/otc/hiroba/top2016.html"><div>2016年</div></a></li>
  <li><a href="https://www.ogis-ri.co.jp/otc/hiroba/top2015.html"><div>2015年</div></a></li>
  <li><a href="https://www.ogis-ri.co.jp/otc/hiroba/top2014.html"><div>2014年</div></a></li>
  <li><a href="https://www.ogis-ri.co.jp/otc/hiroba/top2013.html"><div>2013年</div></a></li>
  <li><a href="https://www.ogis-ri.co.jp/otc/hiroba/top2012.html"><div>2012年</div></a></li>
  <li><a href="https://www.ogis-ri.co.jp/otc/hiroba/top2011.html"><div>2011年</div></a></li>
  <li><a href="https://www.ogis-ri.co.jp/otc/hiroba/top2010.html"><div>2010年</div></a></li>
  <li><a href="https://www.ogis-ri.co.jp/otc/hiroba/top2009.html"><div>2009年</div></a></li>
  <li><a href="https://www.ogis-ri.co.jp/otc/hiroba/top2008.html"><div>2008年</div></a></li>
  <li><a href="https://www.ogis-ri.co.jp/otc/hiroba/top2007.html"><div>2007年</div></a></li>
  <li><a href="https://www.ogis-ri.co.jp/otc/hiroba/top2006.html"><div>2006年</div></a></li>
  <li><a href="https://www.ogis-ri.co.jp/otc/hiroba/top2005.html"><div>2005年</div></a></li>
  <li><a href="https://www.ogis-ri.co.jp/otc/hiroba/top2004.html"><div>2004年</div></a></li>
  <li><a href="https://www.ogis-ri.co.jp/otc/hiroba/top2003.html"><div>2003年</div></a></li>
  <li><a href="https://www.ogis-ri.co.jp/otc/hiroba/top2002.html"><div>2002年</div></a></li>
  <li><a href="https://www.ogis-ri.co.jp/otc/hiroba/top2001.html"><div>2001年</div></a></li>
  <li><a href="https://www.ogis-ri.co.jp/otc/hiroba/top2000.html"><div>2000年</div></a></li>
  <li><a href="https://www.ogis-ri.co.jp/otc/hiroba/top1999.html"><div>1999年</div></a></li>
</ul>
</div>

</aside>
</div>
<footer>
<div id="common-footer" class="cf">
  <ul class="link cf">
	<li><a href="https://www.ogis-ri.co.jp/otc/hiroba/">オブジェクトの広場TOP</a></li>
	<li><a href="https://www.facebook.com/object.no.hiroba/">Facebookページ</a></li>
	<li><a href="https://www.ogis-ri.co.jp/">オージス総研TOP</a></li>
	<li><a href="https://www.ogis-ri.co.jp/extra/notice.html">サイトポリシー</a></li>
  </ul>
  <div class="by-ogis">
    <p>オブジェクトの広場はオージス総研の有志により運営されています</p>
    <div><a href="https://www.ogis-ri.co.jp/"><img src="./高校生でも ETロボコン! ソースコード大公開 _ オブジェクトの広場_files/OGISRI_logo_w.png" alt="OGIS-RI"></a></div>
  </div>
  <div class="copyright">© 2014 OGIS-RI Co., Ltd.</div>
</div>

</footer>


<iframe id="rufous-sandbox" scrolling="no" frameborder="0" allowtransparency="true" allowfullscreen="true" style="position: absolute; visibility: hidden; display: none; width: 0px; height: 0px; padding: 0px; border: none;" title="Twitter analytics iframe" src="./高校生でも ETロボコン! ソースコード大公開 _ オブジェクトの広場_files/saved_resource.html"></iframe></body></html>
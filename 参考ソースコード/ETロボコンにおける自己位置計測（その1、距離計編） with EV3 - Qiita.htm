<!DOCTYPE HTML>
<!-- saved from url=(0058)http://qiita.com/TetsuroAkagawa/items/ba6190f08d26df7cc8ad -->
<!DOCTYPE html PUBLIC "" ""><HTML xmlns:og="http://ogp.me/ns#"><HEAD><META 
content="IE=11.0000" http-equiv="X-UA-Compatible">

<META charset="UTF-8"><TITLE> ETロボコンにおける自己位置計測（その1、距離計編） with EV3 - 
Qiita</TITLE>
<META name="viewport" content="width=device-width,initial-scale=1">
<META name="description" content="&#10;&#10;ETロボコンにおける計測器の活用&#10;&#10;　自己位置計測とは、走行体の移動距離や旋回方位などを逐次計測することによって「走行体がコース上の今どこにいるのか」を判別するものです。自己位置計測は「エリア走行」、「速度計」などの他の要素技術にも必要となる土台とも言える要素技術なので、ここで紹介したいと思います。（出場チームごとによって、自己位置計測の手法や計算式は若干の差異がある場合があります）&#10;　以下に用意しているサンプルプログラムは、ETロボコン2016アドバンストクラス走...">
<META name="twitter:card" content="summary">
<META name="twitter:site" content="@Qiita">
<META name="twitter:creator" content="PsychoGundam009">
<META content=" ETロボコンにおける自己位置計測（その1、距離計編） with EV3 - Qiita" 
property="og:title">
<META content="article" property="og:type">
<META content="http://qiita.com/TetsuroAkagawa/items/ba6190f08d26df7cc8ad" 
property="og:url">
<META content="http://cdn.qiita.com/assets/qiita-fb-2887e7b4aad86fd8c25cea84846f2236.png" 
property="og:image">
<META content="# ETロボコンにおける計測器の活用&#10;　自己位置計測とは、走行体の移動距離や旋回方位などを逐次計測することによって「走行体がコース上の今どこにいるのか」を判別するものです。自己位置計測は「エリア走行」、「速度計」などの他の要素技術にも..." 
property="og:description">
<META content="Qiita" property="og:site_name">
<META content="564524038" property="fb:admins"><LINK href="http://cdn.qiita.com/assets/favicons/public/production-4ff10c1e1e2b5fcb353ff9cafdd56c70.ico" 
rel="shortcut icon" type="image/x-icon"><LINK href="http://cdn.qiita.com/assets/favicons/public/apple-touch-icon-f9a6afad761ec2306e10db2736187c8b.png" 
rel="apple-touch-icon" type="image/png"><LINK title="Qiita" href="/opensearch.xml" 
rel="search" type="application/opensearchdescription+xml"><LINK href="ETロボコンにおける自己位置計測（その1、距離計編）%20with%20EV3%20-%20Qiita.files/public-8f6b46e6e87d7bfce95ce8f6e214fde2.min.css" 
rel="stylesheet" media="all">
<META name="csrf-param" content="authenticity_token"> 
<META name="csrf-token" content="j8hm6w8EXiWSYpPRWg2mh5X2qPp5JOvWWMJSoi6txfRIHY1jcjliywRplcDf2LEJ7A22Qtge5sdQa4wlKg/Ffg==">
<META name="GENERATOR" content="MSHTML 11.00.9600.18666"></HEAD>
<BODY class="without-js"><NOSCRIPT>&lt;iframe height="0" 
src="//www.googletagmanager.com/ns.html?id=GTM-TBQWPN" 
style="display:none;visibility:hidden" width="0"&gt;&lt;/iframe&gt;</NOSCRIPT>
<SCRIPT>
  document.body.className = document.body.className.replace('without-js', '') + ' with-js';
  window.Qiita = {"asset_host":"cdn.qiita.com","TLD":"com","controller_path":"public/items","controller_action":"public/items#show","controller":"items","action":"show","action_path":"public/items#show","env":"production","flash":{},"is_team_page":false,"request_parameters":{"controller":"public/items","action":"show","user_id":"TetsuroAkagawa","type":"items","id":"ba6190f08d26df7cc8ad"},"root_domain":"qiita.com","variant":null,"config":{"mixpanel":{"career":"dd35af27e959781713d63fd7ca898a8d","per_team":"c0a2116368b33b44b5029ebd2cc9b094","public":"be87616606b0e26a87689099aab2c4e5","team":"b7c0342acba2dbc8742484d98788efb3"},"default_locale":"ja","locale":"ja"},"team":null,"user":null,"GIT_BRANCH":null,"DEBUG":false};

</SCRIPT>
 
<DIV class="headerContainer headerContainer-public" role="navigation">
<SCRIPT class="js-react-on-rails-component" type="application/json">{"component_name":"HeaderContainer","props":{"user":null,"team":null,"news":{"type":"Hot","content":"Markdownによる情報共有サービス、Qiita:Team","url":"https://teams.qiita.com?utm_source=qiita\u0026utm_medium=header_news"},"initial_unread_count":null,"siteid_image":"http://cdn.qiita.com/siteid-reverse.png","is_team_page":false,"on_team_setting":false,"show_post_menu":true,"show_search_menu":true,"is_fluid":false,"locale":"ja"},"trace":false,"dom_id":"HeaderContainer-react-component-a1aab504-42cb-4a47-8a7e-2245c94ce364"}</SCRIPT>
     
<DIV 
id="HeaderContainer-react-component-a1aab504-42cb-4a47-8a7e-2245c94ce364"></DIV></DIV>
<DIV id="main">
<SCRIPT type="application/ld+json">{  "@context": "http://schema.org",  "@type": "BreadcrumbList",  "itemListElement": [    {      "@type": "ListItem",      "position": 1,      "item": {        "@id": "/",        "name": "Qiita"      }    },    {      "@type": "ListItem",      "position": 2,      "item": {        "@id": "/items",        "name": "投稿"      }    },    {      "@type": "ListItem",      "position": 3,      "item": {        "@id": "/tags/ET%E3%83%AD%E3%83%9C%E3%82%B3%E3%83%B3",        "name": "ETロボコン"      }    }  ]}</SCRIPT>
<ARTICLE itemtype="http://schema.org/Article" itemscope="">
<DIV class="ArticleMainHeader ">
<DIV class="container"></DIV>
<DIV class="container">
<DIV class="row s-flex-align-center">
<DIV class="col-sm-9">
<H1 class="ArticleMainHeader__title" itemprop="headline"> 
ETロボコンにおける自己位置計測（その1、距離計編） with EV3</H1>
<UL class="TagList">
  <LI class="TagList__item" data-count="39"><A class="u-link-unstyled TagList__label" 
  href="http://qiita.com/tags/ET%E3%83%AD%E3%83%9C%E3%82%B3%E3%83%B3"><IMG 
  class="TagList__icon" alt="ETロボコン" src="ETロボコンにおける自己位置計測（その1、距離計編）%20with%20EV3%20-%20Qiita.files/missing-2e17009a0b32a6423572b0e6dc56727e.png"><SPAN>ETロボコン</SPAN></A></LI>
  <LI class="TagList__item" data-count="61"><A class="u-link-unstyled TagList__label" 
  href="http://qiita.com/tags/EV3"><IMG class="TagList__icon" alt="EV3" src="ETロボコンにおける自己位置計測（その1、距離計編）%20with%20EV3%20-%20Qiita.files/missing-2e17009a0b32a6423572b0e6dc56727e.png"><SPAN>EV3</SPAN></A></LI>
  <LI class="TagList__item" data-count="20"><A class="u-link-unstyled TagList__label" 
  href="http://qiita.com/tags/EV3RT"><IMG class="TagList__icon" alt="EV3RT" src="ETロボコンにおける自己位置計測（その1、距離計編）%20with%20EV3%20-%20Qiita.files/missing-2e17009a0b32a6423572b0e6dc56727e.png"><SPAN>EV3RT</SPAN></A></LI>
  <LI class="TagList__item" data-count="42"><A class="u-link-unstyled TagList__label" 
  href="http://qiita.com/tags/TOPPERS"><IMG class="TagList__icon" alt="TOPPERS" 
  src="ETロボコンにおける自己位置計測（その1、距離計編）%20with%20EV3%20-%20Qiita.files/missing-2e17009a0b32a6423572b0e6dc56727e.png"><SPAN>TOPPERS</SPAN></A></LI></UL></DIV>
<DIV class="col-sm-3">
<DIV class="itemsShowHeaderStock">
<UL class="list-unstyled itemsShowHeaderStock_statusList">
  <LI>
  <DIV class="itemsShowHeaderStock_count stock"><SPAN 
  class="fa fa-thumbs-up"></SPAN><SPAN class="js-likecount">5</SPAN></DIV>
  <DIV class="itemsShowHeaderStock_countText">いいね</DIV></LI>
  <LI>
  <DIV class="itemsShowHeaderStock_count" itemprop="commentCount" content="0 UserComments"><SPAN 
  class="fa fa-comment"></SPAN>0</DIV>
  <DIV class="itemsShowHeaderStock_countText">コメント</DIV></LI></UL></DIV>
<DIV class="js-likebutton" data-props='{"like_status":false,"like_count":5,"uuid":"ba6190f08d26df7cc8ad","likable_type":"Article","position":"article-header"}'></DIV>
<UL class="list-inline ArticleMainHeader__users">
  <LI class="js-hovercard" data-hovercard-target-name="hachiman8"><A href="http://qiita.com/hachiman8" 
  itemprop="url"><IMG class="thumb thumb--xs" alt="hachiman8" src="ETロボコンにおける自己位置計測（その1、距離計編）%20with%20EV3%20-%20Qiita.files/1473757096.png"></A></LI>
  <LI class="js-hovercard" data-hovercard-target-name="yures"><A href="http://qiita.com/yures" 
  itemprop="url"><IMG class="thumb thumb--xs" alt="yures" src="ETロボコンにおける自己位置計測（その1、距離計編）%20with%20EV3%20-%20Qiita.files/1473720417.jpg"></A></LI>
  <LI class="js-hovercard" data-hovercard-target-name="kuboaki"><A href="http://qiita.com/kuboaki" 
  itemprop="url"><IMG class="thumb thumb--xs" alt="kuboaki" src="ETロボコンにおける自己位置計測（その1、距離計編）%20with%20EV3%20-%20Qiita.files/1473755941.jpg"></A></LI>
  <LI class="js-hovercard" data-hovercard-target-name="rokugahanfuji"><A href="http://qiita.com/rokugahanfuji" 
  itemprop="url"><IMG class="thumb thumb--xs" alt="rokugahanfuji" src="ETロボコンにおける自己位置計測（その1、距離計編）%20with%20EV3%20-%20Qiita.files/1479216205.jpg"></A></LI>
  <LI class="js-hovercard" data-hovercard-target-name="mossandayo"><A href="http://qiita.com/mossandayo" 
  itemprop="url"><IMG class="thumb thumb--xs" alt="mossandayo" src="ETロボコンにおける自己位置計測（その1、距離計編）%20with%20EV3%20-%20Qiita.files/1476924209.png"></A></LI></UL></DIV></DIV></DIV></DIV>
<DIV class="ArticleAsideHeader">
<DIV class="container">
<DIV class="u-flex u-space-between">
<DIV class="u-flex u-flex-wrap">
<DIV class="u-flex u-align-center s-pdv-5 u-flex-wrap">
<DIV class="ArticleAsideHeader__author"><A href="http://qiita.com/TetsuroAkagawa"><IMG 
class="thumb thumb--xs" alt="5qjm6plv normal" src="ETロボコンにおける自己位置計測（その1、距離計編）%20with%20EV3%20-%20Qiita.files/5QJm6PLv_normal.jpg"></A> 
<A class="u-link-unstyled" 
href="http://qiita.com/TetsuroAkagawa">TetsuroAkagawa</A> </DIV>
<DIV class="ArticleAsideHeader__date">
<META content="2016-12-27T14:30:59+09:00" itemprop="datePublished"><SPAN title="2016年12月27日に投稿" 
data-toggle="tooltip"><time itemprop="dateModified" datetime="2017-01-14T12:23:22+09:00">2017年01月14日</time>に更新</SPAN></DIV></DIV>
<DIV class="u-flex u-align-center s-pdv-5 mobile-hidden">
<DIV class="ArticleAsideHeader__revision"><A title="編集履歴" href="http://qiita.com/TetsuroAkagawa/items/ba6190f08d26df7cc8ad/revisions" 
data-toggle="tooltip"><SPAN class="fa fa-history"></SPAN></A><SPAN class="ArticleAsideHeader__revisionCount">5</SPAN></DIV></DIV>
<DIV class="u-flex u-align-center s-pdv-5 mobile-hidden"></DIV></DIV>
<DIV class="u-flex u-align-center s-flex-justiry-between s-pdv-5 u-shrink-0">
<DIV class="ArticleAsideHeader__stock">
<DIV class="js-stockbutton" data-props='{"stock_status":false}' data-position="top"></DIV></DIV>
<DIV class="dropdown"><A class="dropdown-toggle" href="http://qiita.com/TetsuroAkagawa/items/ba6190f08d26df7cc8ad#" 
data-toggle="dropdown"><SPAN class="fa fa-ellipsis-h fa-lg"></SPAN></A>
<UL class="dropdown-menu dropdown-menu-right">
  <LI class="dropdown__item--mobile"><A href="http://qiita.com/TetsuroAkagawa/items/ba6190f08d26df7cc8ad/revisions"><SPAN 
  class="fa fa-fw fa-history"></SPAN> 編集履歴<SPAN>(5)</SPAN></A></LI>
  <LI><A 
  href="http://qiita.com/TetsuroAkagawa/items/ba6190f08d26df7cc8ad.md"><SPAN 
  class="fa fa-fw fa-file-text-o"></SPAN> Markdownで本文を見る</A></LI>
  <LI><A href="http://qiita.com/TetsuroAkagawa/items/ba6190f08d26df7cc8ad#" 
  data-toggle="modal" data-target=".js-report-form"><SPAN class="fa fa-fw fa-flag"></SPAN> 
  問題がある投稿を報告する</A></LI></UL></DIV></DIV></DIV></DIV></DIV>
<DIV class="container">
<DIV class="row" id="article-body-wrapper">
<DIV class="col-sm-9"><SECTION class="markdownContent markdownContent-headingEnabled js-task-list-container clearfix position-relative" 
id="item-ba6190f08d26df7cc8ad" itemprop="articleBody">
<H1><SPAN class="fragment" id="etロボコンにおける計測器の活用"></SPAN><A href="http://qiita.com/TetsuroAkagawa/items/ba6190f08d26df7cc8ad#et%E3%83%AD%E3%83%9C%E3%82%B3%E3%83%B3%E3%81%AB%E3%81%8A%E3%81%91%E3%82%8B%E8%A8%88%E6%B8%AC%E5%99%A8%E3%81%AE%E6%B4%BB%E7%94%A8"><I 
class="fa fa-link"></I></A>ETロボコンにおける計測器の活用</H1>
<P>　自己位置計測とは、走行体の移動距離や旋回方位などを逐次計測することによって「走行体がコース上の今どこにいるのか」を判別するものです。自己位置計測は「エリア走行」、「速度計」などの他の要素技術にも必要となる土台とも言える要素技術なので、ここで紹介したいと思います。（出場チームごとによって、自己位置計測の手法や計算式は若干の差異がある場合があります）<BR>
　以下に用意しているサンプルプログラムは、ETロボコン2016アドバンストクラス走行体 「HackEV」 のトレッド幅に合わせた実装になります。</P>
<P><A href="ETロボコンにおける自己位置計測（その1、距離計編）%20with%20EV3%20-%20Qiita.files/6ae9af51-8cf2-194c-deb3-c7f18dcd8961.jpg" 
target="_blank" rel="nofollow noopener"><IMG alt="IMG_1128.jpg" src="ETロボコンにおける自己位置計測（その1、距離計編）%20with%20EV3%20-%20Qiita.files/6ae9af51-8cf2-194c-deb3-c7f18dcd8961.jpg"></A><BR>こちらの写真が、その「HackEV」になります。</P>
<P>[利用開発環境]<BR>・OS：Windows7<BR>・環境：TOPPERS/EV3RT<BR>・言語：C言語</P>
<H1><SPAN class="fragment" id="距離計"></SPAN><A href="http://qiita.com/TetsuroAkagawa/items/ba6190f08d26df7cc8ad#%E8%B7%9D%E9%9B%A2%E8%A8%88"><I 
class="fa fa-link"></I></A>距離計</H1>
<H2><SPAN class="fragment" id="距離計の概要"></SPAN><A href="http://qiita.com/TetsuroAkagawa/items/ba6190f08d26df7cc8ad#%E8%B7%9D%E9%9B%A2%E8%A8%88%E3%81%AE%E6%A6%82%E8%A6%81"><I 
class="fa fa-link"></I></A>距離計の概要</H2>
<P>　まずは「距離計」について説明します。距離計は「走行体の移動に対して、車輪がどれほど回転したか」という情報を基に、走行体が移動した距離を計測する技術です。もっと具体的な言い方をしますと「車輪の円周に回転量（回転角度）を乗算した結果が走行距離になる」ということです。</P>
<P>　納豆巻きの海苔を剥がしながらコロコロ転がしていく感じを想像してください。納豆巻きの海苔が全て剥がれた時、納豆巻きが転がって移動した距離は巻かれている海苔の幅に等しくなります。この納豆巻きを車輪に置き換えて考えますと、その「海苔の幅」こそが車輪の円周になるのです。</P>
<P><A href="ETロボコンにおける自己位置計測（その1、距離計編）%20with%20EV3%20-%20Qiita.files/d481cb39-4618-3767-6127-1c2b2c1f0af4.png" 
target="_blank" rel="nofollow noopener"><IMG alt="W_info.png" src="ETロボコンにおける自己位置計測（その1、距離計編）%20with%20EV3%20-%20Qiita.files/d481cb39-4618-3767-6127-1c2b2c1f0af4.png"></A></P>
<P>　要するに、車輪の円周と回転角度さえ分かれば、移動距離を計測することが可能なのです。円周は車輪の直径を実際に測ることで計算して出しましょう。</P>
<P><A href="ETロボコンにおける自己位置計測（その1、距離計編）%20with%20EV3%20-%20Qiita.files/ee538256-c5c0-c7ad-c8b6-bae5f3a157f4.jpg" 
target="_blank" rel="nofollow noopener"><IMG alt="IMG_1127.jpg" src="ETロボコンにおける自己位置計測（その1、距離計編）%20with%20EV3%20-%20Qiita.files/ee538256-c5c0-c7ad-c8b6-bae5f3a157f4.jpg"></A><BR>このようにノギスなどで車輪の直径を測りましょう。もちろん定規でもそれなりの精度で距離計を利用することができます。</P>
<H2><SPAN class="fragment" id="距離計のサンプルプログラム"></SPAN><A href="http://qiita.com/TetsuroAkagawa/items/ba6190f08d26df7cc8ad#%E8%B7%9D%E9%9B%A2%E8%A8%88%E3%81%AE%E3%82%B5%E3%83%B3%E3%83%97%E3%83%AB%E3%83%97%E3%83%AD%E3%82%B0%E3%83%A9%E3%83%A0"><I 
class="fa fa-link"></I></A>距離計のサンプルプログラム</H2>
<P>　以下に距離計のサンプルプログラムを記述します。このプログラムでは、距離の計測値を更新する関数 Distance_update() 
を4ms周期で呼び出す前提で記述されています。そして4ms間の移動距離[mm]を毎回足し合わせることによって、これまでの移動距離を計測しています。4ms間隔ごとに納豆巻きから剥がれた海苔を細かく千切っていって、最後に全部繋げている感じとなります。.........そろそろ車輪が納豆巻きに見えてきた頃だと思いますので、この例えはここまでにしましょう。</P>
<P><A href="ETロボコンにおける自己位置計測（その1、距離計編）%20with%20EV3%20-%20Qiita.files/af1bff2a-3025-60ff-3a80-0ef35b4223ff.png" 
target="_blank" rel="nofollow noopener"><IMG alt="距離計.png" src="ETロボコンにおける自己位置計測（その1、距離計編）%20with%20EV3%20-%20Qiita.files/af1bff2a-3025-60ff-3a80-0ef35b4223ff.png"></A></P>
<P>　このような構造にしているのは、モータの角度に影響を与えることなく（APIの ev3_motor_reset_counts 
を呼び出すことなく）、距離計の計測値のリセットなどを行えるようにするためです。</P>
<P>以下のサンプルプログラムの利用方法について説明します。利用手順は以下のようになります。</P>
<P>1.プログラム起動時に、初期化関数 Distance_init() を呼び出す（1回のみ呼び出し）<BR>2.タスクの先頭に更新関数 
Distance_update() を呼び出す（タスク周期毎に呼び出し）<BR>3.現在の走行距離を得たいときに、距離取得関数 
Distance_getDistance() を呼び出す</P>
<P>以上が手順になります。あと、左右タイヤの4ms間の距離を取得する関数（Distance_getDistance4msRight()，Distance_getDistance4msLeft() 
）が入っていますが、これは次記事で説明する「方位計測」で用いる関数ですので、ここでは関係ありません。</P>
<DIV class="code-frame" data-lang="c">
<DIV class="code-lang"><SPAN class="bold">Distance.c</SPAN></DIV>
<DIV class="highlight">
<PRE><SPAN class="cp">#include "Distance.h"</SPAN>

<SPAN class="cp">#define TIRE_DIAMETER 81.0  </SPAN><SPAN class="c1">//タイヤ直径（81mm）</SPAN>

<SPAN class="k">static</SPAN> <SPAN class="kt">float</SPAN> <SPAN class="n">distance</SPAN> <SPAN class="o">=</SPAN> <SPAN class="mf">0.0</SPAN><SPAN class="p">;</SPAN>     <SPAN class="c1">//走行距離</SPAN>
<SPAN class="k">static</SPAN> <SPAN class="kt">float</SPAN> <SPAN class="n">distance4msL</SPAN> <SPAN class="o">=</SPAN> <SPAN class="mf">0.0</SPAN><SPAN class="p">;</SPAN> <SPAN class="c1">//左タイヤの4ms間の距離</SPAN>
<SPAN class="k">static</SPAN> <SPAN class="kt">float</SPAN> <SPAN class="n">distance4msR</SPAN> <SPAN class="o">=</SPAN> <SPAN class="mf">0.0</SPAN><SPAN class="p">;</SPAN> <SPAN class="c1">//右タイヤの4ms間の距離</SPAN>
<SPAN class="k">static</SPAN> <SPAN class="kt">float</SPAN> <SPAN class="n">pre_angleL</SPAN><SPAN class="p">,</SPAN> <SPAN class="n">pre_angleR</SPAN><SPAN class="p">;</SPAN> <SPAN class="c1">// 左右モータ回転角度の過去値</SPAN>

<SPAN class="cm">/* 初期化関数 */</SPAN>
<SPAN class="kt">void</SPAN> <SPAN class="nf">Distance_init</SPAN><SPAN class="p">()</SPAN> <SPAN class="p">{</SPAN>
    <SPAN class="c1">//各変数の値の初期化</SPAN>
    <SPAN class="n">distance</SPAN> <SPAN class="o">=</SPAN> <SPAN class="mf">0.0</SPAN><SPAN class="p">;</SPAN>
    <SPAN class="n">distance4msR</SPAN> <SPAN class="o">=</SPAN> <SPAN class="mf">0.0</SPAN><SPAN class="p">;</SPAN>
    <SPAN class="n">distance4msL</SPAN> <SPAN class="o">=</SPAN> <SPAN class="mf">0.0</SPAN><SPAN class="p">;</SPAN>
    <SPAN class="c1">//モータ角度の過去値に現在値を代入</SPAN>
    <SPAN class="n">pre_angleL</SPAN> <SPAN class="o">=</SPAN> <SPAN class="n">ev3_motor_get_counts</SPAN><SPAN class="p">(</SPAN><SPAN class="n">left_motor</SPAN><SPAN class="p">);</SPAN>
    <SPAN class="n">pre_angleR</SPAN> <SPAN class="o">=</SPAN> <SPAN class="n">ev3_motor_get_counts</SPAN><SPAN class="p">(</SPAN><SPAN class="n">right_motor</SPAN><SPAN class="p">);</SPAN>
<SPAN class="p">}</SPAN>

<SPAN class="cm">/* 距離更新（4ms間の移動距離を毎回加算している） */</SPAN>
<SPAN class="kt">void</SPAN> <SPAN class="nf">Distance_update</SPAN><SPAN class="p">(){</SPAN>
    <SPAN class="kt">float</SPAN> <SPAN class="n">cur_angleL</SPAN> <SPAN class="o">=</SPAN> <SPAN class="n">ev3_motor_get_counts</SPAN><SPAN class="p">(</SPAN><SPAN class="n">left_motor</SPAN><SPAN class="p">);</SPAN> <SPAN class="c1">//左モータ回転角度の現在値</SPAN>
    <SPAN class="kt">float</SPAN> <SPAN class="n">cur_angleR</SPAN> <SPAN class="o">=</SPAN> <SPAN class="n">ev3_motor_get_counts</SPAN><SPAN class="p">(</SPAN><SPAN class="n">right_motor</SPAN><SPAN class="p">);</SPAN><SPAN class="c1">//右モータ回転角度の現在値</SPAN>
    <SPAN class="kt">float</SPAN> <SPAN class="n">distance4ms</SPAN> <SPAN class="o">=</SPAN> <SPAN class="mf">0.0</SPAN><SPAN class="p">;</SPAN>        <SPAN class="c1">//4msの距離</SPAN>

    <SPAN class="c1">// 4ms間の走行距離 = ((円周率 * タイヤの直径) / 360) * (モータ角度過去値　- モータ角度現在値)</SPAN>
    <SPAN class="n">distance4msL</SPAN> <SPAN class="o">=</SPAN> <SPAN class="p">((</SPAN><SPAN class="n">PI</SPAN> <SPAN class="o">*</SPAN> <SPAN class="n">TIRE_DIAMETER</SPAN><SPAN class="p">)</SPAN> <SPAN class="o">/</SPAN> <SPAN class="mf">360.0</SPAN><SPAN class="p">)</SPAN> <SPAN class="o">*</SPAN> <SPAN class="p">(</SPAN><SPAN class="n">cur_angleL</SPAN> <SPAN class="o">-</SPAN> <SPAN class="n">pre_angleL</SPAN><SPAN class="p">);</SPAN>  <SPAN class="c1">// 4ms間の左モータ距離</SPAN>
    <SPAN class="n">distance4msR</SPAN> <SPAN class="o">=</SPAN> <SPAN class="p">((</SPAN><SPAN class="n">PI</SPAN> <SPAN class="o">*</SPAN> <SPAN class="n">TIRE_DIAMETER</SPAN><SPAN class="p">)</SPAN> <SPAN class="o">/</SPAN> <SPAN class="mf">360.0</SPAN><SPAN class="p">)</SPAN> <SPAN class="o">*</SPAN> <SPAN class="p">(</SPAN><SPAN class="n">cur_angleR</SPAN> <SPAN class="o">-</SPAN> <SPAN class="n">pre_angleR</SPAN><SPAN class="p">);</SPAN>  <SPAN class="c1">// 4ms間の右モータ距離</SPAN>
    <SPAN class="n">distance4ms</SPAN> <SPAN class="o">=</SPAN> <SPAN class="p">(</SPAN><SPAN class="n">distance4msL</SPAN> <SPAN class="o">+</SPAN> <SPAN class="n">distance4msR</SPAN><SPAN class="p">)</SPAN> <SPAN class="o">/</SPAN> <SPAN class="mf">2.0</SPAN><SPAN class="p">;</SPAN> <SPAN class="c1">//左右タイヤの走行距離を足して割る</SPAN>
    <SPAN class="n">distance</SPAN> <SPAN class="o">+=</SPAN> <SPAN class="n">distance4ms</SPAN><SPAN class="p">;</SPAN>

    <SPAN class="c1">//モータの回転角度の過去値を更新</SPAN>
    <SPAN class="n">pre_angleL</SPAN> <SPAN class="o">=</SPAN> <SPAN class="n">cur_angleL</SPAN><SPAN class="p">;</SPAN>
    <SPAN class="n">pre_angleR</SPAN> <SPAN class="o">=</SPAN> <SPAN class="n">cur_angleR</SPAN><SPAN class="p">;</SPAN>
<SPAN class="p">}</SPAN>

<SPAN class="cm">/* 走行距離を取得 */</SPAN>
<SPAN class="kt">float</SPAN> <SPAN class="nf">Distance_getDistance</SPAN><SPAN class="p">(){</SPAN>
    <SPAN class="k">return</SPAN> <SPAN class="n">distance</SPAN><SPAN class="p">;</SPAN>
<SPAN class="p">}</SPAN>

<SPAN class="cm">/* 右タイヤの4ms間の距離を取得 */</SPAN>
<SPAN class="kt">float</SPAN> <SPAN class="nf">Distance_getDistance4msRight</SPAN><SPAN class="p">(){</SPAN>
    <SPAN class="k">return</SPAN> <SPAN class="n">distance4msR</SPAN><SPAN class="p">;</SPAN>
<SPAN class="p">}</SPAN>

<SPAN class="cm">/* 左タイヤの4ms間の距離を取得 */</SPAN>
<SPAN class="kt">float</SPAN> <SPAN class="nf">Distance_getDistance4msLeft</SPAN><SPAN class="p">(){</SPAN>
    <SPAN class="k">return</SPAN> <SPAN class="n">distance4msL</SPAN><SPAN class="p">;</SPAN>
<SPAN class="p">}</SPAN>
</PRE></DIV></DIV>
<DIV class="code-frame" data-lang="c">
<DIV class="code-lang"><SPAN class="bold">Distance.h</SPAN></DIV>
<DIV class="highlight">
<PRE><SPAN class="cp">#ifndef _DISTANCE_H_</SPAN>
<SPAN class="cp">#define _DISTANCE_H_</SPAN>

<SPAN class="cp">#include "ev3api.h"</SPAN>
<SPAN class="cp">#include "parameter.h"</SPAN>

<SPAN class="cm">/* 円周率 */</SPAN>
<SPAN class="cp">#define PI 3.14159265358</SPAN>

<SPAN class="cm">/* 初期化関数 */</SPAN>
<SPAN class="kt">void</SPAN> <SPAN class="nf">Distance_init</SPAN><SPAN class="p">();</SPAN>

<SPAN class="cm">/* 距離を更新 */</SPAN>
<SPAN class="kt">void</SPAN> <SPAN class="nf">Distance_update</SPAN><SPAN class="p">();</SPAN>

<SPAN class="cm">/* 走行距離を取得 */</SPAN>
<SPAN class="kt">float</SPAN> <SPAN class="nf">Distance_getDistance</SPAN><SPAN class="p">();</SPAN>

<SPAN class="cm">/* 右タイヤの4ms間の距離を取得 */</SPAN>
<SPAN class="kt">float</SPAN> <SPAN class="nf">Distance_getDistance4msRight</SPAN><SPAN class="p">();</SPAN>

<SPAN class="cm">/* 左タイヤの4ms間の距離を取得 */</SPAN>
<SPAN class="kt">float</SPAN> <SPAN class="nf">Distance_getDistance4msLeft</SPAN><SPAN class="p">();</SPAN>
<SPAN class="cp">#endif</SPAN>
</PRE></DIV></DIV>
<H2><SPAN class="fragment" id="距離計プログラムの実行例動画"></SPAN><A href="http://qiita.com/TetsuroAkagawa/items/ba6190f08d26df7cc8ad#%E8%B7%9D%E9%9B%A2%E8%A8%88%E3%83%97%E3%83%AD%E3%82%B0%E3%83%A9%E3%83%A0%E3%81%AE%E5%AE%9F%E8%A1%8C%E4%BE%8B%E5%8B%95%E7%94%BB"><I 
class="fa fa-link"></I></A>距離計プログラムの実行例（動画）</H2>
<P>400mm前進します。<BR><A href="http://www.youtube.com/watch?v=rVEOAQJJ1KU" target="_blank" 
rel="nofollow noopener"><IMG alt="IMAGE ALT TEXT HERE" src="ETロボコンにおける自己位置計測（その1、距離計編）%20with%20EV3%20-%20Qiita.files/0.jpg"></A></P>
<P>以下が、その実行コード（一部抜粋）となります。</P>
<DIV class="code-frame" data-lang="text">
<DIV class="highlight">
<PRE>typedef enum {
    AHEAD,
    END
} RUN_STATE;

void main_task(intptr_t unused) {
    static RUN_STATE state = AHEAD;

    /* モーター出力ポートの設定 */
    ev3_motor_config(left_motor, LARGE_MOTOR);
    ev3_motor_config(right_motor, LARGE_MOTOR);

    /* 計測器初期化 */
    Distance_init();
    Direction_init();

    while(1) {
        /* 距離計，方位計 更新 */
        Distance_update();
        Direction_update();

        switch(state) {
        case AHEAD:
            //左右車輪駆動
            ev3_motor_set_power(left_motor, 30);
            ev3_motor_set_power(right_motor, 30);
            //400mm以上前進したら，次状態遷移
            if(Distance_getDistance() &gt; 400.0) {
                state = END;
            }
            break;
        case END:
            //左右車輪停止
            ev3_motor_stop(left_motor, true);
            ev3_motor_stop(right_motor, true);
            break;
        default:
            break;
        }
    }
}
</PRE></DIV></DIV>
<DIV class="hidden">
<FORM class="js-task-list-update" action="/TetsuroAkagawa/items/ba6190f08d26df7cc8ad" 
method="post" 
accept-charset="UTF-8"><INPUT name="utf8" type="hidden" value="✓"><INPUT name="_method" type="hidden" value="patch"><INPUT name="authenticity_token" type="hidden" value="s8h3k21D+Ei0+Qi8GzeXnMSVDNSgijGGh7iyRvbRPrx0HZwbEH7EpiLyDq2e4oASvW4SbAGwPJePEWzB8nM+Ng=="><INPUT name="updated_at_confirmation_in_unixtime" class="js-task-list-updated-at" id="updated_at_confirmation_in_unixtime" type="hidden" value="1484364202"><TEXTAREA name="raw_body" class="js-task-list-field" id="raw_body"># ETロボコンにおける計測器の活用
　自己位置計測とは、走行体の移動距離や旋回方位などを逐次計測することによって「走行体がコース上の今どこにいるのか」を判別するものです。自己位置計測は「エリア走行」、「速度計」などの他の要素技術にも必要となる土台とも言える要素技術なので、ここで紹介したいと思います。（出場チームごとによって、自己位置計測の手法や計算式は若干の差異がある場合があります）
　以下に用意しているサンプルプログラムは、ETロボコン2016アドバンストクラス走行体 「HackEV」 のトレッド幅に合わせた実装になります。

![IMG_1128.jpg](https://qiita-image-store.s3.amazonaws.com/0/153774/6ae9af51-8cf2-194c-deb3-c7f18dcd8961.jpeg)
こちらの写真が、その「HackEV」になります。

[利用開発環境]
・OS：Windows7
・環境：TOPPERS/EV3RT
・言語：C言語
# 距離計
## 距離計の概要
　まずは「距離計」について説明します。距離計は「走行体の移動に対して、車輪がどれほど回転したか」という情報を基に、走行体が移動した距離を計測する技術です。もっと具体的な言い方をしますと「車輪の円周に回転量（回転角度）を乗算した結果が走行距離になる」ということです。

　納豆巻きの海苔を剥がしながらコロコロ転がしていく感じを想像してください。納豆巻きの海苔が全て剥がれた時、納豆巻きが転がって移動した距離は巻かれている海苔の幅に等しくなります。この納豆巻きを車輪に置き換えて考えますと、その「海苔の幅」こそが車輪の円周になるのです。

![W_info.png](https://qiita-image-store.s3.amazonaws.com/0/153774/d481cb39-4618-3767-6127-1c2b2c1f0af4.png)

　要するに、車輪の円周と回転角度さえ分かれば、移動距離を計測することが可能なのです。円周は車輪の直径を実際に測ることで計算して出しましょう。

![IMG_1127.jpg](https://qiita-image-store.s3.amazonaws.com/0/153774/ee538256-c5c0-c7ad-c8b6-bae5f3a157f4.jpeg)
このようにノギスなどで車輪の直径を測りましょう。もちろん定規でもそれなりの精度で距離計を利用することができます。

## 距離計のサンプルプログラム
　以下に距離計のサンプルプログラムを記述します。このプログラムでは、距離の計測値を更新する関数 Distance_update() を4ms周期で呼び出す前提で記述されています。そして4ms間の移動距離[mm]を毎回足し合わせることによって、これまでの移動距離を計測しています。4ms間隔ごとに納豆巻きから剥がれた海苔を細かく千切っていって、最後に全部繋げている感じとなります。.........そろそろ車輪が納豆巻きに見えてきた頃だと思いますので、この例えはここまでにしましょう。

![距離計.png](https://qiita-image-store.s3.amazonaws.com/0/153774/af1bff2a-3025-60ff-3a80-0ef35b4223ff.png)


　このような構造にしているのは、モータの角度に影響を与えることなく（APIの ev3_motor_reset_counts を呼び出すことなく）、距離計の計測値のリセットなどを行えるようにするためです。

以下のサンプルプログラムの利用方法について説明します。利用手順は以下のようになります。

1.プログラム起動時に、初期化関数 Distance_init() を呼び出す（1回のみ呼び出し）
2.タスクの先頭に更新関数 Distance_update() を呼び出す（タスク周期毎に呼び出し）
3.現在の走行距離を得たいときに、距離取得関数 Distance_getDistance() を呼び出す

以上が手順になります。あと、左右タイヤの4ms間の距離を取得する関数（Distance_getDistance4msRight()，Distance_getDistance4msLeft() ）が入っていますが、これは次記事で説明する「方位計測」で用いる関数ですので、ここでは関係ありません。

```Distance.c
#include "Distance.h"

#define TIRE_DIAMETER 81.0  //タイヤ直径（81mm）

static float distance = 0.0;     //走行距離
static float distance4msL = 0.0; //左タイヤの4ms間の距離
static float distance4msR = 0.0; //右タイヤの4ms間の距離
static float pre_angleL, pre_angleR; // 左右モータ回転角度の過去値

/* 初期化関数 */
void Distance_init() {
	//各変数の値の初期化
	distance = 0.0;
	distance4msR = 0.0;
	distance4msL = 0.0;
	//モータ角度の過去値に現在値を代入
	pre_angleL = ev3_motor_get_counts(left_motor);
	pre_angleR = ev3_motor_get_counts(right_motor);
}

/* 距離更新（4ms間の移動距離を毎回加算している） */
void Distance_update(){
	float cur_angleL = ev3_motor_get_counts(left_motor); //左モータ回転角度の現在値
	float cur_angleR = ev3_motor_get_counts(right_motor);//右モータ回転角度の現在値
	float distance4ms = 0.0;		//4msの距離

	// 4ms間の走行距離 = ((円周率 * タイヤの直径) / 360) * (モータ角度過去値　- モータ角度現在値)
	distance4msL = ((PI * TIRE_DIAMETER) / 360.0) * (cur_angleL - pre_angleL);	// 4ms間の左モータ距離
	distance4msR = ((PI * TIRE_DIAMETER) / 360.0) * (cur_angleR - pre_angleR);	// 4ms間の右モータ距離
	distance4ms = (distance4msL + distance4msR) / 2.0; //左右タイヤの走行距離を足して割る
	distance += distance4ms;
	
	//モータの回転角度の過去値を更新
	pre_angleL = cur_angleL;
	pre_angleR = cur_angleR;
}

/* 走行距離を取得 */
float Distance_getDistance(){
	return distance;
}

/* 右タイヤの4ms間の距離を取得 */
float Distance_getDistance4msRight(){
	return distance4msR;
}

/* 左タイヤの4ms間の距離を取得 */
float Distance_getDistance4msLeft(){
	return distance4msL;
}
```

```Distance.h
#ifndef _DISTANCE_H_
#define _DISTANCE_H_

#include "ev3api.h"
#include "parameter.h"

/* 円周率 */
#define PI 3.14159265358

/* 初期化関数 */
void Distance_init();

/* 距離を更新 */
void Distance_update();

/* 走行距離を取得 */
float Distance_getDistance();

/* 右タイヤの4ms間の距離を取得 */
float Distance_getDistance4msRight();

/* 左タイヤの4ms間の距離を取得 */
float Distance_getDistance4msLeft();
#endif
```

## 距離計プログラムの実行例（動画）
400mm前進します。
[![IMAGE ALT TEXT HERE](http://img.youtube.com/vi/rVEOAQJJ1KU/0.jpg)](http://www.youtube.com/watch?v=rVEOAQJJ1KU)

以下が、その実行コード（一部抜粋）となります。

```
typedef enum {
	AHEAD,
	END
} RUN_STATE;

void main_task(intptr_t unused) {
	static RUN_STATE state = AHEAD;

	/* モーター出力ポートの設定 */
	ev3_motor_config(left_motor, LARGE_MOTOR);
	ev3_motor_config(right_motor, LARGE_MOTOR);

	/* 計測器初期化 */
	Distance_init();
	Direction_init();

	while(1) {
		/* 距離計，方位計 更新 */
		Distance_update();
		Direction_update();

		switch(state) {
		case AHEAD:
			//左右車輪駆動
			ev3_motor_set_power(left_motor, 30);
			ev3_motor_set_power(right_motor, 30);
			//400mm以上前進したら，次状態遷移
			if(Distance_getDistance() &gt; 400.0) {
				state = END;
			}
			break;
		case END:
			//左右車輪停止
			ev3_motor_stop(left_motor, true);
			ev3_motor_stop(right_motor, true);
			break;
		default:
			break;
		}
	}
}
```
</TEXTAREA><INPUT name="commit" type="submit" value="Save changes" data-disable-with="Save changes"></FORM></DIV></SECTION></DIV>
<DIV class="col-sm-3">
<DIV class="socialButtons">
<DIV class="socialButtons_twitter"><A class="twitter-share-button" href="https://twitter.com/share" 
data-url="http://qiita.com/TetsuroAkagawa/items/ba6190f08d26df7cc8ad" data-text=" ETロボコンにおける自己位置計測（その1、距離計編） with EV3 by @PsychoGundam009 on @Qiita">ツイート</A></DIV>
<DIV class="socialButtons_hatebu"><A title="はてブに追加" class="hatena-bookmark-button" 
href="http://b.hatena.ne.jp/entry/http://qiita.com/TetsuroAkagawa/items/ba6190f08d26df7cc8ad" 
data-hatena-bookmark-title=" ETロボコンにおける自己位置計測（その1、距離計編） with EV3" 
data-hatena-bookmark-layout="simple-balloon"><IMG width="20" height="20" style="border: currentColor; border-image: none;" 
alt="はてブに追加" src="ETロボコンにおける自己位置計測（その1、距離計編）%20with%20EV3%20-%20Qiita.files/button-only@2x.png"></A>
<SCRIPT src="ETロボコンにおける自己位置計測（その1、距離計編）%20with%20EV3%20-%20Qiita.files/bookmark_button.js" type="text/javascript" charset="utf-8" async="async"></SCRIPT>
</DIV>
<DIV class="socialButtons_googlePlus">
<DIV class="g-plusone" data-size="medium" data-href="http://qiita.com/TetsuroAkagawa/items/ba6190f08d26df7cc8ad"></DIV></DIV>
<DIV class="socialButtons_facebook">
<DIV class="fb-like" data-href="http://qiita.com/TetsuroAkagawa/items/ba6190f08d26df7cc8ad" 
data-show-faces="false" data-share="false" data-layout="button_count" 
data-action="like"></DIV></DIV>
<DIV class="socialButtons_pocket"><A class="pocket-btn" data-lang="en" 
data-pocket-label="pocket" 
data-pocket-count="horizontal"></A></DIV></DIV><SECTION class="itemsShowAuthorInfo" 
itemtype="http://schema.org/Person" itemscope="" itemprop="author"><A href="http://qiita.com/TetsuroAkagawa"><IMG 
class="itemsShowAuthorInfo_userIcon" alt="" src="ETロボコンにおける自己位置計測（その1、距離計編）%20with%20EV3%20-%20Qiita.files/5QJm6PLv_normal.jpg" 
itemprop="image"></A>
<DIV class="itemsShowAuthorInfo_profileStats"><STRONG class="itemsShowAuthorInfo_userName" 
itemprop="name"><A href="http://qiita.com/TetsuroAkagawa" 
itemprop="url">TetsuroAkagawa</A></STRONG>
<DIV class="itemsShowAuthorInfo_contribution"><SPAN class="itemsShowAuthorInfo_count">9</SPAN><SPAN 
class="itemsShowAuthorInfo_unit">Contribution</SPAN></DIV>
<SCRIPT id="js-react-on-rails-context" type="application/json">null</SCRIPT>
 
<SCRIPT class="js-react-on-rails-component" type="application/json">{"component_name":"UserFollowButton","props":{"initial_followed_by":false,"position":"author-info","size":"btn-xs","url_name":"TetsuroAkagawa"},"trace":false,"dom_id":"UserFollowButton-react-component-f8d7d7bf-86a8-4957-92bb-a2917a1895cc"}</SCRIPT>
     
<DIV 
id="UserFollowButton-react-component-f8d7d7bf-86a8-4957-92bb-a2917a1895cc"></DIV></DIV><SECTION 
class="itemsShowAuthorPopularItems">
<H5 class="itemsShowAuthorPopularItems_sectionTitle">人気の投稿</H5>
<UL class="itemsShowAuthorPopularItems_posts list-unstyled">
  <LI itemtype="http://schema.org/Article" itemscope=""><A href="http://qiita.com/TetsuroAkagawa/items/ba6190f08d26df7cc8ad" 
  itemprop="url" data-label="AuthorPopularItemsAtSidebar" 
  track="click">ETロボコンにおける自己位置計測（その1、距離計編） with EV3</A></LI>
  <LI itemtype="http://schema.org/Article" itemscope=""><A href="http://qiita.com/TetsuroAkagawa/items/4e7de30523d9c7ec6241" 
  itemprop="url" data-label="AuthorPopularItemsAtSidebar" 
  track="click">ETロボコンにおける自己位置計測（その２、方位計編） with EV3</A></LI>
  <LI itemtype="http://schema.org/Article" itemscope=""><A href="http://qiita.com/TetsuroAkagawa/items/075d74f5ab49f592450b" 
  itemprop="url" data-label="AuthorPopularItemsAtSidebar" 
  track="click">ETロボコンにおける自己位置計測（その3、座標移動編） with EV3</A></LI>
  <LI itemtype="http://schema.org/Article" itemscope=""><A href="http://qiita.com/TetsuroAkagawa/items/1798c12e9517e6f1cbe9" 
  itemprop="url" data-label="AuthorPopularItemsAtSidebar" 
  track="click">ETロボコンにおける自己位置の応用（エリア分割） with EV3   
</A></LI></UL></SECTION></SECTION>
<DIV class="scroll-chaser">
<DIV class="ad_frame_right_banner_1"></DIV>
<SCRIPT src="ETロボコンにおける自己位置計測（その1、距離計編）%20with%20EV3%20-%20Qiita.files/adjs_set_pro.js" defer="" type="text/javascript" charset="UTF-8" async=""></SCRIPT>
</DIV>
<SCRIPT class="js-react-on-rails-component" type="application/json">{"component_name":"Toc","props":{"body":"\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#et%E3%83%AD%E3%83%9C%E3%82%B3%E3%83%B3%E3%81%AB%E3%81%8A%E3%81%91%E3%82%8B%E8%A8%88%E6%B8%AC%E5%99%A8%E3%81%AE%E6%B4%BB%E7%94%A8\"\u003eETロボコンにおける計測器の活用\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E8%B7%9D%E9%9B%A2%E8%A8%88\"\u003e距離計\u003c/a\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#%E8%B7%9D%E9%9B%A2%E8%A8%88%E3%81%AE%E6%A6%82%E8%A6%81\"\u003e距離計の概要\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E8%B7%9D%E9%9B%A2%E8%A8%88%E3%81%AE%E3%82%B5%E3%83%B3%E3%83%97%E3%83%AB%E3%83%97%E3%83%AD%E3%82%B0%E3%83%A9%E3%83%A0\"\u003e距離計のサンプルプログラム\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E8%B7%9D%E9%9B%A2%E8%A8%88%E3%83%97%E3%83%AD%E3%82%B0%E3%83%A9%E3%83%A0%E3%81%AE%E5%AE%9F%E8%A1%8C%E4%BE%8B%E5%8B%95%E7%94%BB\"\u003e距離計プログラムの実行例（動画）\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n","wrapper":"#article-body-wrapper"},"trace":false,"dom_id":"Toc-react-component-55a33d4a-f0c2-458a-b367-320ee34af851"}</SCRIPT>
     
<DIV 
id="Toc-react-component-55a33d4a-f0c2-458a-b367-320ee34af851"></DIV></DIV></DIV>
<DIV class="row">
<DIV class="col-sm-9">
<DIV class="ArticleFooter__menu">
<DIV class="s-flex-align-center">
<DIV class="js-likebutton" data-props='{"like_status":false,"like_count":5,"show_count":true,"uuid":"ba6190f08d26df7cc8ad","likable_type":"Article","position":"article-footer"}'></DIV>
<DIV class="ArticleFooter__userList">
<DIV class="ArticleFooter__user">
<DIV class="js-hovercard" data-hovercard-target-name="mossandayo"><A href="http://qiita.com/mossandayo" 
itemprop="url"><IMG class="thumb thumb--xs" alt="mossandayo" src="ETロボコンにおける自己位置計測（その1、距離計編）%20with%20EV3%20-%20Qiita.files/1476924209.png"></A></DIV></DIV>
<DIV class="ArticleFooter__user">
<DIV class="js-hovercard" data-hovercard-target-name="rokugahanfuji"><A href="http://qiita.com/rokugahanfuji" 
itemprop="url"><IMG class="thumb thumb--xs" alt="rokugahanfuji" src="ETロボコンにおける自己位置計測（その1、距離計編）%20with%20EV3%20-%20Qiita.files/1479216205.jpg"></A></DIV></DIV>
<DIV class="ArticleFooter__user">
<DIV class="js-hovercard" data-hovercard-target-name="kuboaki"><A href="http://qiita.com/kuboaki" 
itemprop="url"><IMG class="thumb thumb--xs" alt="kuboaki" src="ETロボコンにおける自己位置計測（その1、距離計編）%20with%20EV3%20-%20Qiita.files/1473755941.jpg"></A></DIV></DIV>
<DIV class="ArticleFooter__user">
<DIV class="js-hovercard" data-hovercard-target-name="yures"><A href="http://qiita.com/yures" 
itemprop="url"><IMG class="thumb thumb--xs" alt="yures" src="ETロボコンにおける自己位置計測（その1、距離計編）%20with%20EV3%20-%20Qiita.files/1473720417.jpg"></A></DIV></DIV>
<DIV class="ArticleFooter__user">
<DIV class="js-hovercard" data-hovercard-target-name="hachiman8"><A href="http://qiita.com/hachiman8" 
itemprop="url"><IMG class="thumb thumb--xs" alt="hachiman8" src="ETロボコンにおける自己位置計測（その1、距離計編）%20with%20EV3%20-%20Qiita.files/1473757096.png"></A></DIV></DIV></DIV></DIV>
<DIV class="u-flex u-align-center">
<DIV class="ArticleFooter__stock">
<DIV class="js-stockbutton" data-props='{"stock_status":false}' data-position="footer_menu"></DIV></DIV>
<DIV class="ArticleFooter__editRequest"><A title="投稿者に記事をより良くするための提案ができます 💪" 
class="u-link-no-underline" href="http://qiita.com/drafts/ba6190f08d26df7cc8ad/edit" 
data-toggle="tooltip"><SPAN class="fa fa-send-o fa-lg"></SPAN> 
<SPAN>編集リクエスト</SPAN></A></DIV>
<DIV class="dropdown ArticleFooter__dropdown"><A class="dropdown-toggle" href="http://qiita.com/TetsuroAkagawa/items/ba6190f08d26df7cc8ad#" 
data-toggle="dropdown"><SPAN class="fa fa-ellipsis-h"></SPAN></A>
<UL class="dropdown-menu dropdown-menu-right">
  <LI><A 
  href="http://qiita.com/TetsuroAkagawa/items/ba6190f08d26df7cc8ad.md"><SPAN 
  class="fa fa-fw fa-file-text-o"></SPAN> Markdownで本文を見る</A></LI>
  <LI><A href="http://qiita.com/TetsuroAkagawa/items/ba6190f08d26df7cc8ad#" 
  data-toggle="modal" data-target=".js-report-form"><I 
  class="fa fa-fw fa-flag"></I> 問題がある投稿を報告する</A></LI></UL></DIV></DIV></DIV>
<UL class="references js-referencesView">
  <LI class="references_header"><I class="fa fa-fw fa-link"></I> 
  この記事は以下の記事からリンクされています</LI>
  <LI class="references_reference js-reference"><A href="http://qiita.com/TetsuroAkagawa/items/4e7de30523d9c7ec6241#_reference-9f8eb43c5494e8fdd314"><IMG 
  width="18" height="18" alt="" src="ETロボコンにおける自己位置計測（その1、距離計編）%20with%20EV3%20-%20Qiita.files/5QJm6PLv_normal.jpg">ETロボコンにおける自己位置計測（その２、方位計編） 
  with EV3</A><SPAN>からリンク</SPAN><time class="references_datetime js-dateTimeView" 
  datetime="2017-01-14T03:23:55+00:00">5ヶ月前</time></LI>
  <LI class="references_reference js-reference"><A href="http://qiita.com/mossandayo/items/fab3c1fc2a97bb0fbcfc#_reference-bc25013cb6a20f8385ef"><IMG 
  width="18" height="18" alt="" src="ETロボコンにおける自己位置計測（その1、距離計編）%20with%20EV3%20-%20Qiita.files/1476924209.png">EV3に関する技術記事まとめ</A><SPAN>からリンク</SPAN><time 
  class="references_datetime js-dateTimeView" datetime="2017-01-16T00:39:29+00:00">5ヶ月前</time></LI>
  <LI class="references_reference js-reference"><A href="http://qiita.com/TetsuroAkagawa/items/075d74f5ab49f592450b#_reference-e244341eeba9d7227ae8"><IMG 
  width="18" height="18" alt="" src="ETロボコンにおける自己位置計測（その1、距離計編）%20with%20EV3%20-%20Qiita.files/5QJm6PLv_normal.jpg">ETロボコンにおける自己位置計測（その3、座標移動編） 
  with EV3</A><SPAN>からリンク</SPAN><time class="references_datetime js-dateTimeView" 
  datetime="2017-01-27T03:39:28+00:00">4ヶ月前</time></LI></UL>
<DIV class="itemsShowBody_articleColumnFooter">
<DIV class="socialButtons">
<DIV class="socialButtons_twitter"><A class="twitter-share-button" href="https://twitter.com/share" 
data-url="http://qiita.com/TetsuroAkagawa/items/ba6190f08d26df7cc8ad" data-text=" ETロボコンにおける自己位置計測（その1、距離計編） with EV3 by @PsychoGundam009 on @Qiita">ツイート</A></DIV>
<DIV class="socialButtons_hatebu"><A title="はてブに追加" class="hatena-bookmark-button" 
href="http://b.hatena.ne.jp/entry/http://qiita.com/TetsuroAkagawa/items/ba6190f08d26df7cc8ad" 
data-hatena-bookmark-title=" ETロボコンにおける自己位置計測（その1、距離計編） with EV3" 
data-hatena-bookmark-layout="simple-balloon"><IMG width="20" height="20" style="border: currentColor; border-image: none;" 
alt="はてブに追加" src="ETロボコンにおける自己位置計測（その1、距離計編）%20with%20EV3%20-%20Qiita.files/button-only@2x.png"></A>
<SCRIPT src="ETロボコンにおける自己位置計測（その1、距離計編）%20with%20EV3%20-%20Qiita.files/bookmark_button.js" type="text/javascript" charset="utf-8" async="async"></SCRIPT>
</DIV>
<DIV class="socialButtons_googlePlus">
<DIV class="g-plusone" data-size="medium" data-href="http://qiita.com/TetsuroAkagawa/items/ba6190f08d26df7cc8ad"></DIV></DIV>
<DIV class="socialButtons_facebook">
<DIV class="fb-like" data-href="http://qiita.com/TetsuroAkagawa/items/ba6190f08d26df7cc8ad" 
data-show-faces="false" data-share="false" data-layout="button_count" 
data-action="like"></DIV></DIV>
<DIV class="socialButtons_pocket"><A class="pocket-btn" data-lang="en" 
data-pocket-label="pocket" data-pocket-count="horizontal"></A></DIV></DIV></DIV>
<DIV class="itemsShowComment_wrapper" id="comments">
<SCRIPT class="js-react-on-rails-component" type="application/json">{"component_name":"PublicCommentListContainer","props":{"currentUser":null,"initialComments":[],"monthly_public_image_uploadable_size_limit":null,"total_uploaded_public_image_size_in_current_month":null,"item":{"id":455781,"uuid":"ba6190f08d26df7cc8ad","suspended":false,"secret":false},"owner":{"url_name":"TetsuroAkagawa"},"is_team":false,"is_project":false,"logged_in":false,"polling":false,"mention_candidates":[{"id":153774,"url_name":"TetsuroAkagawa","profile_image_url":"https://pbs.twimg.com/profile_images/596090876847259648/5QJm6PLv_normal.jpg"}]},"trace":false,"dom_id":"PublicCommentListContainer-react-component-2aa73c57-b9f3-4cc5-9f23-fa5cf02e51da"}</SCRIPT>
     
<DIV id="PublicCommentListContainer-react-component-2aa73c57-b9f3-4cc5-9f23-fa5cf02e51da"></DIV></DIV></DIV></DIV></DIV></ARTICLE>
<DIV class="js-report-form modal fade reportForm">
<DIV class="modal-dialog">
<DIV class="modal-content">
<DIV class="modal-header"><BUTTON name="button" class="close" type="submit" 
data-dismiss="modal">×</BUTTON>
<H4 class="modal-title">問題がある投稿を報告する</H4></DIV>
<DIV class="modal-body">
<FORM action="/reports" method="post" 
accept-charset="UTF-8"><INPUT name="utf8" type="hidden" value="✓"><INPUT name="authenticity_token" type="hidden" value="aBm59mhSpe+t4TZNIxLfIe/bdYu0c//O3eaE5DbN/f6vzFJ+FW+ZATvqMFymx8ivliBrMxVJ8t/VT1pjMm/9dA=="><INPUT name="redirect_path" id="redirect_path" type="hidden" value="/TetsuroAkagawa/items/ba6190f08d26df7cc8ad"><INPUT name="item_uuid" id="item_uuid" type="hidden" value="ba6190f08d26df7cc8ad">
<P>この投稿にどのような問題がありますか？</P><BR>
<DIV class="form-group">
<UL class="list-unstyled">
  <LI><LABEL><INPUT name="report_type" id="report_type_spam" required="required" 
  type="radio" value="spam"> スパムです </LABEL></LI>
  <LI><LABEL><INPUT name="report_type" id="report_type_harassment" required="required" 
  type="radio" value="harassment"> 攻撃的または迷惑な内容を含んでいます </LABEL></LI>
  <LI><LABEL><INPUT name="report_type" id="report_type_inappropriate_content" 
  required="required" type="radio" value="inappropriate_content"> 不適切な内容を含んでいます 
  </LABEL></LI></UL></DIV>
<DIV class="reportForm_submitButtonContainer"><BUTTON name="button" class="btn btn-primary reportForm_submitButton" 
type="submit"><I class="fa fa-send"></I> 
送信</BUTTON></DIV></FORM></DIV></DIV></DIV></DIV>
<SCRIPT id="js-item" type="application/json">{ "url": "http://qiita.com/TetsuroAkagawa/items/ba6190f08d26df7cc8ad", "id": 455781, "uuid": "ba6190f08d26df7cc8ad" }</SCRIPT>

<SCRIPT class="js-user" type="application/json">{&quot;id&quot;:153774,&quot;url_name&quot;:&quot;TetsuroAkagawa&quot;,&quot;profile_image_url&quot;:&quot;https://pbs.twimg.com/profile_images/596090876847259648/5QJm6PLv_normal.jpg&quot;}</SCRIPT>

<SCRIPT language="JavaScript" src="ETロボコンにおける自己位置計測（その1、距離計編）%20with%20EV3%20-%20Qiita.files/qiita_bigmining.js" type="text/javascript"></SCRIPT>
</DIV><FOOTER class="footer">
<DIV class="footer_inner">
<DIV class="footer_container">
<UL class="footer_links-left">
  <LI class="footer_link"><A class="footer_copyright" href="http://increments.co.jp/">© 
  2011-2017 Increments Inc.</A></LI>
  <LI class="footer_link"><A href="http://qiita.com/terms">利用規約</A></LI>
  <LI class="footer_link"><A href="http://qiita.com/privacy">プライバシー</A></LI>
  <LI class="footer_link"><A href="http://help.qiita.com/">ヘルプ</A></LI>
  <LI class="footer_link"><A href="https://increments.zendesk.com/anonymous_requests/new">お問い合わせ</A></LI></UL>
<UL class="footer_links-right">
  <LI class="footer_link"><A href="http://qiita.com/about">Qiitaとは</A></LI>
  <LI class="footer_link"><A href="http://qiita.com/users">ユーザー</A></LI>
  <LI class="footer_link"><A href="http://qiita.com/tags">タグ</A></LI>
  <LI class="footer_link"><A href="http://blog.qiita.com/">ブログ</A></LI>
  <LI class="footer_link"><A href="http://qiita.com/api/v2/docs">API</A></LI>
  <LI class="footer_link"><A href="https://teams.qiita.com/">Team</A></LI>
  <LI class="footer_link"><A href="http://kobito.qiita.com/">Kobito</A></LI>
  <LI class="footer_link"><A class="js-public-form-feedback-link" href="http://qiita.com/TetsuroAkagawa/items/" 
  data-toggle="modal" data-target=".js-feedback-form"><I 
  class="fa fa-heart"></I> ご意見 <I 
class="fa fa-caret-down"></I></A></LI></UL></DIV></DIV></FOOTER>
<DIV class="js-feedback-form modal fade feedbackForm">
<DIV class="modal-dialog">
<DIV class="modal-content">
<DIV class="modal-header"><BUTTON name="button" class="close" type="submit" 
data-dismiss="modal">×</BUTTON>
<H4 class="modal-title">ご意見</H4></DIV>
<DIV class="modal-body">
<FORM class="js-feedback-form-form" action="/feedbacks" method="post" 
accept-charset="UTF-8"><INPUT name="utf8" type="hidden" value="✓"><INPUT name="authenticity_token" type="hidden" value="oHnBAWIwnoU20AYlI8bx2Cdmo5dRpMiYZtPW9OdhFshnrCqJHw2ia6DbADSmE+ZWXp29L/CexYlueghz48MWQg=="><INPUT name="redirect_path" id="redirect_path" type="hidden" value="/TetsuroAkagawa/items/ba6190f08d26df7cc8ad">
<DIV class="form-group"><TEXTAREA name="feedback[message]" class="form-control js-feedback-form-text-area" id="feedback_message" required="required" placeholder="Qiitaについてのご意見をお聞かせください。" rows="5">Qiitaについてのご意見をお聞かせください。</TEXTAREA></DIV>
<DIV class="feedbackForm_submitButtonContainer"><BUTTON name="button" class="btn btn-primary feedbackForm_submitButton" 
type="submit"><I class="fa fa-send"></I> 送信</BUTTON>
<P class="feedbackForm_note">いただいたご意見への返信は行っておりません。<BR>返信の必要な内容については、<A href="https://increments.zendesk.com/anonymous_requests/new">こちら</A> 
からお問い合わせください。</P></DIV>
<DIV style="top: -99999px; position: fixed; opacity: 0.0001;"><INPUT name="feedback[name]" type="text"></DIV></FORM></DIV></DIV></DIV></DIV>
<SCRIPT>// if (window.mixpanel instanceof Element) {
//   window.mixpanel = [];
// }
// (function(f,b){if(!b.__SV){var a,e,i,g;window.mixpanel=b;b._i=[];b.init=function(a,e,d){function f(b,h){var a=h.split(".");2==a.length&&(b=b[a[0]],h=a[1]);b[h]=function(){b.push([h].concat(Array.prototype.slice.call(arguments,0)))}}var c=b;"undefined"!==typeof d?c=b[d]=[]:d="mixpanel";c.people=c.people||[];c.toString=function(b){var a="mixpanel";"mixpanel"!==d&&(a+="."+d);b||(a+=" (stub)");return a};c.people.toString=function(){return c.toString(1)+".people (stub)"};i="disable track track_pageview track_links track_forms register register_once alias unregister identify name_tag set_config people.set people.set_once people.increment people.append people.track_charge people.clear_charges people.delete_user".split(" ");
// for(g=0;g<i.length;g++)f(c,i[g]);b._i.push([a,e,d])};b.__SV=1.2;a=f.createElement("script");a.type="text/javascript";a.async=!0;a.src="//cdn.mxpnl.com/libs/mixpanel-2.2.min.js";e=f.getElementsByTagName("script")[0];e.parentNode.insertBefore(a,e)}})(document,window.mixpanel||[]);</SCRIPT>

<SCRIPT src="ETロボコンにおける自己位置計測（その1、距離計編）%20with%20EV3%20-%20Qiita.files/public-ea9634d328dd01703100922f07784313.min.js"></SCRIPT>

<SCRIPT>
  (function () {
    var script = document.getElementsByTagName('script')[0];
    var load = function (src, id) {
      var el = document.createElement('script');
      el.async = true;
      el.src = src;
      el.id = id;
      script.parentNode.insertBefore(el, script);
    };
      // Optimizely
      load('//cdn.optimizely.com/js/52738645.js', 'optimizely-jssdk');
      // Google Analytics
      window._gaq = window._gaq || [];
      var isCareer = location.hostname.split('.')[0] == 'career';
      if (isCareer) {
        window._gaq.push(['_setAccount', 'UA-24675221-11']);
        window._gaq.push(['_setDomainName', 'qiita.com']);
      } else {
        window._gaq.push(['_setAccount', 'UA-24675221-1']);
      }
      window._gaq.push(['_setCustomVar', 1, 'logged_in', 'false', 2]);
      window._gaq.push(['_trackPageview']);
      var src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      load(src, 'google-analytics-jssdk');
    // Google Analytics - Universal Analytics
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
        ga('create', 'UA-24675221-12', {
          
        });
          ga('create', 'UA-90226750-1', { name: 'user' });
          ga('user.send', 'pageview');
        ga('set', 'dimension1', 'false');
        ga('set', 'dimension3', 'false');
      ga('require', 'displayfeatures');
      ga('set', 'forceSSL', true);
      ga('send', 'pageview');
    // Google Tag Manager
      (function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
      new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
      j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
      '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
      })(window,document,'script','dataLayer','GTM-TBQWPN');
  })();
</SCRIPT>
 </BODY></HTML>
